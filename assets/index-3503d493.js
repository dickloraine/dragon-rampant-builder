import{u as Se,c as Ea,a as Ha,i as g,j as e,B as b,T as M,I as L,b as x,D as E,d as H,e as U,L as z,f as V,g as He,h as Re,k as Q,l as k,F as de,m as Ue,C as Be,n as se,S as ue,o as ke,M as ne,p as P,q as he,r as F,s as Ht,t as Ne,v as qe,w as Ge,x as W,y as O,z as ce,A as Ua,E as Ft,G as Ut,H as Ba,J as Le,K as Na,N as xe,O as qa,P as Ga,Q as Vt,R as Bt,U as Ya,V as Nt,W as Ce,X as _e,Y as we,Z as Ae,_ as Ja,$ as Za,a0 as Qa,a1 as Xa,a2 as Ka,a3 as es,a4 as ts,a5 as as,a6 as ss,a7 as ns}from"./mui-33dba682.js";import{a as os,R as y,e as rs,r as G}from"./react-adf67704.js";import{u as is,b as ls,c as cs,d as De,e as me,f as re,g as ds,h as us,i as hs,P as ms}from"./redux-4a00fe89.js";import{l as ve,F as ps}from"./localstorage-1d97b8aa.js";import{t as fs,f as xs,a as gs,u as qt,F as Te,C as Ye,c as vs,b as X,d as A,e as S,g as K}from"./hookform-3e9f604a.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var Gt,Wt=os;Gt=Wt.createRoot,Wt.hydrateRoot;const j=is,p=ls,ys=t=>({palette:{mode:t?"dark":"light",primary:{main:"#3f51b5",light:"#7986cb",dark:"#303f9f",contrastText:"#fff"},secondary:{light:"#ff4081",main:"#f50057",dark:"#c51162",contrastText:"#fff"}},typography:{h2:{fontWeight:400,fontSize:"2.125rem",lineHeight:1.235,letterSpacing:"0.00735em"},h3:{fontWeight:400,fontSize:"1.5rem",lineHeight:1.334,letterSpacing:"0em"},h4:{fontWeight:500,fontSize:"1.25rem",lineHeight:1.6,letterSpacing:"0.0075em"},h5:{fontWeight:500,fontSize:"1.1rem",lineHeight:1.6,letterSpacing:"0.0075em"},h6:{fontWeight:400,fontSize:"1.1rem",lineHeight:1.6,letterSpacing:"0.0075em"}},components:{MuiTextField:{defaultProps:{margin:"normal"}},MuiTooltip:{defaultProps:{enterDelay:500,leaveDelay:100,disableInteractive:!0}}}}),js=()=>{const t=Se("(prefers-color-scheme: dark)"),s=p(o=>o.ui.darkMode),n=s===null?t:s;return y.useMemo(()=>Ea(ys(n)),[n])},bs={Leader:{name:"Leader",points:0,exclude_units:[],description:"The leader of the army."},Cleric:{name:"Cleric",points:4,exclude_units:["Ravenous Hordes","Scouts","Light Missiles","Heavy Missiles","Bellicose Foot","Lesser Warbeasts","Greater Warbeasts","Light Riders"],description:"A Cleric unit counts as using Enchanted melee weapons against Undead units, without needing to roll for effectiveness. A Cleric may choose to ignore Fear caused by the Undead.",short:"Reroll all misses against Undead units, ignore Fear caused by the Undead."},Slayer:{name:"Slayer",points:4,exclude_units:["Ravenous Hordes","Scouts","Light Missiles","Heavy Missiles","Lesser Warbeasts","Greater Warbeasts","Light Riders"],description:"A Slayer unit counts as using Enchanted melee weapons against one Type of enemies, without needing to roll for effectiveness. A Slayer may choose to ignore Fear caused by that Type.",short:"Reroll all misses against one type of enemies, ignore Fear caused by that enemy."},Exploder:{name:"Exploder",points:2,exclude_units:["Ravenous Hordes","Scouts"],description:`As an ordered activation successful on 5+, an Exploder unit will explode. A failed activation test means an implosion occurs, and the unit is removed from play without damaging any other units, and counts as casualties.    The explosion affects all units – friend and foe alike – within a 6" radius of the exploding unit. This works exactly as a Shoot action hitting on 3+ (the number of dice rolled depending on the Exploder's Strength Points, as for all Shooting), but affects all units within the blast zone. Once exploded, the Exploder unit is removed from the table and counts as destroyed.`,short:'As an ordered activation on 5+: 3+ shooting attack against all units in 6".'},Fear:{name:"Fear",points:2,exclude_units:[],description:"Courage Tests caused as a result of Attacking (but not Shooting) by a Fear unit suffer an additional -1 to the total. Should two units that cause Fear encounter one another, the effect of this rule is cancelled between those units. Undead units are not affected by Fear.",short:"Enemy courage Tests caused by close combat -1."},Fearful:{name:"Fearful",points:-2,exclude_units:["Ravenous Hordes"],description:"Every Courage and Rally test suffers -1 to the total; if attacked by a unit causing Fear, Courage tests are taken at -2.",short:"Every Courage and Rally test suffers -1."},Flying:{name:"Flying",points:2,exclude_units:["Ravenous Hordes"],description:'A Flying unit may move over friends and enemies during its movement, but at the end of its move must adhere to the 3" proximity rule just like any other unit. This is still a great advantage, as units may not usually interpenetrate in Dragon Rampant. Flying units ignore all terrain for movement and Attacks (as will their opponent for Attacks), and they never benefit from cover. Units targeted by a Flying unit will only benefit from cover if it is buildings, woods, or some other overhead cover. When retreating, a Flying unit must move its Maximum movement, and may move over any other unit; this may result in it retreating off the table more often that you would wish!',short:"May move over friends and enemies during its movement. Flying units ignore all terrain for movement and Attacks; no cover. When retreating, move the Maximum movement."},Burrowing:{name:"Burrowing",points:2,exclude_units:["Ravenous Hordes"],description:'A Burrowing unit may move under friends and enemies during its movement, but at the end of its move must adhere to the 3" proximity rule just like any other unit. This is still a great advantage, as units may not usually interpenetrate in Dragon Rampant. Burrowing units ignore all terrain for movement and Attacks (as will their opponent for Attacks), and they never benefit from cover. Units targeted by a Burrowing unit will only benefit from cover if it is buildings, woods, or some other overhead cover. When retreating, a Burrowing unit must move its Maximum movement, and may move under any other unit; this may result in it retreating off the table more often that you would wish!',short:"May move under friends and enemies during its movement. Flying units ignore all terrain for movement and Attacks; no cover. When retreating, move the Maximum movement."},Hatred:{name:"Hatred",points:1,exclude_units:[],description:"Units with Hatred gain the Wild Charge against enemy units they have Hatred of. Units with Hatred that already have the Wild Charge special rule automatically pass their Wild Charge tests against enemy units they have Hatred of, meaning that your unit must always Attack.",short:"Gain the Wild Charge against enemy units they have Hatred of."},Invisibility:{name:"Invisibility",points:3,exclude_units:["Ravenous Hordes"],description:"Invisible units may not be targeted by ranged attacks except for spells, and do not block line of sight. Invisible units become visible during Attacks and may be targeted by enemy Attacks. Invisible units may achieve objectives and use the unit proximity rule in the same way as other units; they cannot be passed through by other units, as everyone senses their presence even if they can't see them clearly.",short:"May not be targeted by ranged attacks except for spells, and do not block line of sight."},"Enchanted Weapons":{name:"Enchanted Weapons",points:1,exclude_units:["Ravenous Hordes"],description:"At the start of each game, before deployment, roll one die to see if your weapons will give you a magical edge against your current opponents: on a roll of a 6, the weapon's enchantment becomes effective versus all enemy units. An effective enchanted weapon rerolls all misses (once) in all Attacks (melee) or Shooting (missile).",short:"On a roll of a 6: reroll all misses."},"Blessed Weapons":{name:"Blessed Weapons",points:2,exclude_units:["Ravenous Hordes"],description:"At the start of each game, before deployment, roll one die to see if your weapons will give you a magical edge against your current opponents: on a roll of a 5-6, the weapon's enchantment becomes effective versus all enemy units. An effective blessed weapon rerolls all misses (once) in all Attacks (melee) or Shooting (missile).",short:"On a roll of a 5+: reroll all misses."},"Mystical Armour":{name:"Mystical Armour",points:2,exclude_units:["Ravenous Hordes"],description:"If a unit is equipped with mystical armour, for every Strength Point lost, roll one  die. On a roll of a 6, that point will be ignored.",short:"On a roll of a 6, strength point loss will be ignored."},Spellcaster:{name:"Spellcaster",points:4,exclude_units:["Ravenous Hordes","Scouts","Light Missiles","Heavy Missiles","Bellicose Foot","Lesser Warbeasts","Greater Warbeasts","Light Riders"],description:"Can cast all Spells from the Spell Table.",short:"Can cast all Spells."},Wizardlings:{name:"Wizardlings",points:2,exclude_units:["Ravenous Hordes","Scouts","Light Missiles","Heavy Missiles","Bellicose Foot","Lesser Warbeasts","Greater Warbeasts","Light Riders"],description:"A Wizardling chooses three spells from the Spell Table, and may not use any other spells. The spells must be chosen before the scenario is announced.",short:"Can cast 3 Spells."},Summoner:{name:"Summoner",points:3,exclude_units:["Ravenous Hordes","Scouts","Bellicose Foot","Lesser Warbeasts","Greater Warbeasts","Light Riders"],description:`As an ordered activation on 6+, a Summoner unit may try to raise 1 unit per turn. A Summoner that is at half strength or below (6 or 3 Strength Points) has a –1 modifier to its activation test for Summoning. If you deploy a Summoner in a scenario where some of your units are deployed off-table, a –1 modifier is applied to all Summoning activation tests for the scenario's duration. If successful, the summoned unit must be placed within 12" of the Summoner, and no closer than 6" to an enemy unit. If this is not achievable, the successfully summoned unit may not be placed until summoned again in another turn. A summoned unit may be any Flying, Burrowing or Undead unit, or other creatures that both players agree can materialize or spring from the ground. The summoned unit may not take further action in this phase, but will do so during your next turn. Until on the table, the summoned units do not count as casualties or for victory purposes.`,short:'Ordered activation on 6+: place the summond unit within 12", no closer than 6" to an enemy.'},"No Feelings":{name:"No Feelings",points:0,exclude_units:[],description:"Undead. Courage value of 0+. This means that your unit will never become Battered, but will still rout on a negative final score (their magical reanimation being broken). They also ignore the effect of Fear. Such units are, however, fragile due to a lack of armour or calcium deficiency, meaning that any hits inflicted during Attacks are rounded up (as opposed to down) when working out how many Strength Points are lost.",short:"Undead. Courage value of 0+, ignore the effect of Fear. Any hits inflicted during Attacks are rounded up."},"Unstoppable March of the Dead":{name:"Unstoppable March of the Dead",points:0,exclude_units:[],description:"This is a Leader trait usable by a Warband consisting only of units from the Graveyard Dwellers list (see later); it may be selected instead of the rolled Trait if you roll an 8 or higher on the Leader Skills table. Your Warband only takes Courage tests for casualties from Attacking or Shooting, and when Rallying.",short:"Your Warband only takes Courage tests for casualties from Attacking or Shooting, and when Rallying."},Venomous:{name:"Venomous",points:2,exclude_units:[],description:"Any Attack die (but not Defence die) that rolls 6 does 2 Strength Points of damage.",short:"Any Attack die (but not Defence die) that rolls 6 does 2 Strength Points of damage."}},Ss={Chariots:{name:"Chariots",description:"May not enter rough terrain. Armor is increased to 4.",short:"May not enter rough terrain. Armor 4."},"Counter-charge":{name:"Counter-charge",description:"When an enemy has successfully diced to Attack this unit,  but before it moves, this unit may test for a counter-charge. Test for an Attack at 7+. If it succeeds, the two units meet a proportionate movement distance between their start positions, and both count as Attacking. If it fails, it stands in place for the enemy's charge. Counter-charge may not be used if the unit is Battered.",short:"On 7+ move half towards attacker and count as attacking too."},"Counter-charge vs. foot":{name:"Counter-charge vs. foot",description:"When an enemy has successfully diced to Attack this unit,  but before it moves, this unit may test for a counter-charge. Test for an Attack at 7+. If it succeeds, the two units meet a proportionate movement distance between their start positions, and both count as Attacking. If it fails, it stands in place for the enemy's charge. Counter-charge may not be used if the unit is Battered.",short:"On 7+ move half towards attacker and count as attacking too."},Evade:{name:"Evade",description:'When an enemy has successfully diced to Attack this unit, but before it moves, this unit may test to Evade at 7+. If it succeeds, it immediately carries out a Skirmish action targeting the Attacking unit only, may not move closer to the Attacking unit, and must avoid other units by 3" as usual; casualties inflicted in the Skirmish action cause a Courage test only at the end of the Attack. The charging unit then moves its full charge distance following the Evading unit; if it makes contact it Attacks with the Evading unit reducing its Armour to 1, and if it cannot contact it must move as close as possible. If the Evade test fails, the unit stands in place and awaits attack without shooting or moving, and its Armour drops to 1 during the Attack. Evade cannot be used if the unit is Battered.',short:"If attacked: On 7+ take a skirmish action against the attacker. If still reached, -1 armor. If failed, armor 1."},"Fleet Footed":{name:"Fleet Footed",description:"This unit does not halve its movement in rough terrain.",short:"Move normally through rough terrain."},"Hard to target":{name:"Hard to target",description:'Scouts count as Armour 2 versus Shooting and may only be targeted within 12".',short:'Count as Armour 2 versus Shooting and may only be targeted within 12".'},Ranger:{name:"Ranger",description:"This unit uses its normal Attack/Defence/Armour profile when fighting in rough terrain.",short:"Use the normal Attack/Defence/armor profile when fighting in rough terrain."},Skirmish:{name:"Skirmish",description:"As an ordered activation, successful on a 7+, the unit may choose to make a half move and Shoot either before or after this movement takes place. All models in the unit Shoot with –1 to their dice scores.",short:"On 7+ half move and shoot. Shoot value -1."},"Wall of Spears":{name:"Wall of Spears",description:"There needs to be 6 or more Strength Points in unit to form a Wall of Spears. On a Move order, form the unit into base-to-base contact; a Wall of Spears cannot form in rough terrain or in cover, and it cannot move in this formation. Wall of Spears increases their Armour by 1 point against Attacks but not Shooting (to 4 for Heavy Foot). If the unit becomes Battered or must retreat while in a Wall of Spears, the formation is broken.",short:"Needs 6 or more Strength Points. On a Move order, form the unit into base-to-base contact; increase Armor by 1 against Attacks."},"Wild Charge":{name:"Wild Charge",description:"If the unit is within Attack range of an enemy unit, you must test to activate an Attack; this is the only order the unit can be given. Wild Charge may not be used if the unit is Battered.",short:"Unit must attack if able."}},Rs={"Almighty Prod!":{name:"Almighty Prod!",difficulty:6,target:'Friendly unit within 18"',duration:"Until start of player's next activation phase (unless used before that).",effect:"If the target unit fails its next Ordered Activation roll it may immediately re-roll the test (once). The spell’s effect ends immediately whether successful or not.",short:"Target unit may re-roll next Ordered Activation."},"Banish Fear!":{name:"Banish Fear!",difficulty:6,target:'Friendly unit within 18"',duration:"Until the start of the player's next activation phase.",effect:"The target unit may re-roll all failed Courage tests (once per test).",short:"Target unit may re-roll all failed Courage tests."},"Heal Thee!":{name:"Heal Thee!",difficulty:7,target:'Friendly unit within 18"',duration:"1 immediate action",effect:"Restore 1 Strength Point to a friendly unit within range. Strength may not rise above unit's original value.",short:"Restore 1 Strength Point to a friendly unit."},"Befuddle Thee!":{name:"Befuddle Thee!",difficulty:7,target:'Enemy unit within 18"',duration:"Until the unit Rallies",effect:"Automatically Batters an Unbattered unit within range.",short:"Automatically Batters an Unbattered unit."},"Bog Thee!":{name:"Bog Thee!",difficulty:7,target:'Enemy unit within 18"',duration:"Until the end of the target's next activation phase.",effect:"A quagmire springs up around the target unit; any movement or combat it is involved in counts as in rough terrain. Movement of other units is not affected. There is no effect if the target unit is in or moves into 'real' rough terrain.",short:"Target counts as in rough terrain."},"Dragon's Breath!":{name:"Dragon's Breath!",difficulty:7,target:'Self or any unit within 18"',duration:"Until the end of the target's next activation phase.",effect:"A magical wall of mist or fog is thrown up around the target unit; it may not Shoot or be Shot at, but may still be targeted by spells and moves as normal (the Dragon's Breath moves with it).",short:"Target may not Shoot or be Shot at, but may still be targeted by spells and moves as normal."},"Power Bolt!":{name:"Power Bolt!",difficulty:7,target:'Enemy unit within 18"',duration:"1 immediate Shoot action",effect:'A magical attack of flame, electric, poison, or whatever else suits your Spellcaster. This works exactly as a Shoot action, with a Shoot Value of 4+ (suffering –1 to dice rolls for targets over 12" away).',short:'Shoot attack with Shoot Value of 4+ (-1 for targets over 12").'},"Sharper Blades!":{name:"Sharper Blades!",difficulty:7,target:'Self or friendly unit within 18"',duration:"Until the start of the player's next activation phase.",effect:"The target unit may re-roll all failed Attack or Defence dice (once per Attack).",short:"The target unit may re-roll all failed Attack or Defence dice."},"Stronger Shields!":{name:"Stronger Shields!",difficulty:7,target:'Self or friendly unit within 18"',duration:"Until the start of the player's next activation phase.",effect:"The target unit's Armor increases by 1.",short:"Armor +1."},"Sod-off Spell!":{name:"Sod-off Spell!",difficulty:8,target:'One bespelled unit within 18"',duration:"Immediate cancellation",effect:"This spell cancels out the effect of any spells currently affecting one unit with a duration of 'Until the start of the player's next activation phase' or 'Until the unit Rallies'. If successful, the effect of all applicable spells on the targeted units are ended immediately. The spellcaster cannot target itself.",short:"Cancels out the effect of any spells currently affecting one unit."}},ks={Unworthy:{name:"Unworthy",roll:3,description:"After deployment and whether your Leader is on the table or not, roll one die for each of your units (except Leader's). On the roll of a 1, that unit deserts and is immediately removed from play (not counting as casualties).",short:"Roll one die for each of your units. On a 1 that unit is removed from play."},Insipid:{name:"Insipid",roll:4,description:'Offers units within 12" no Courage bonus.',short:'Offers units within 12" no Courage bonus.'},Cowardly:{name:"Cowardly",roll:5,description:"Leader's unit may not be given an Attack order.",short:"Leader's unit may not be given an Attack order."},Weakling:{name:"Weakling",roll:6,description:"Leader's unit rolls 1 fighting die less in all Attacks and when Shooting (therefore rolling either 11 or 5 dice).",short:"Leader's unit rolls 1 fighting die less"},Brutal:{name:"Brutal",roll:7,description:'Any units within 12" of your Leader model may automatically pass failed Rally tests by removing one Strength Point (a sacrificed friend works wonders for morale...).',short:'Any units within 12" may automatically pass failed Rally tests by removing one Strength Point.'},Wise:{name:"Wise",roll:8,description:"Renowned for strategic insight, you may add or subtract 1 from your final total (whichever you prefer) when dicing to decide attacker/defender.",short:"You may add or subtract 1 from your final total when dicing to decide attacker/defender."},Brave:{name:"Brave",roll:9,description:"Leader's unit is not affected by Fear.",short:"Leader's unit is not affected by Fear."},Strong:{name:"Strong",roll:10,description:"During Attacks (whether attacking or defending), Leader's unit may reroll one failed hit die.",short:"During Attacks, Leader's unit may reroll one failed hit die."},Commanding:{name:"Commanding",roll:11,description:`You may reroll (once) a failed Move, Attack, or Shoot order within 12" of your Leader's model, once per turn.`,short:`You may reroll a failed Move, Attack, or Shoot order within 12" of your Leader's model.`},Goader:{name:"Goader",roll:12,description:'Each turn, one unit within 12" of your Leader model may automatically pass a Move activation test without needing to roll dice.',short:'One unit within 12" of your Leader model may automatically pass a Move activation test.'},Boneshaker:{name:"Goader",roll:13,description:'Each turn, one unit within 12" of your Leader model may automatically pass an Attack activation test without needing to roll dice (but not a Wild Charge).',short:'One unit within 12" of your Leader model may automatically pass an Attack activation test.'},"Sky Darkener":{name:"Sky Darkener",roll:14,description:'Each turn, one unit within 12" of your Leader model may automatically pass a Shoot activation test without needing to roll dice.',short:'One unit within 12" of your Leader model may automatically pass a Shoot activation test.'},Formidable:{name:"Formidable",roll:15,description:"During Attacks (whether attacking or defending), Leader's unit may reroll up to two failed hit dice.",short:"During Attacks, Leader's unit may reroll up to two failed hit dice."},Patient:{name:"Patient",roll:16,description:'Each turn, one unit within 12" of your Leader model may choose to ignore a compulsory Wild Charge, and may instead take an ordered action in your ordered activation phase.',short:'One unit within 12" of your Leader model may choose to ignore a compulsory Wild Charge, and take an ordered action.'},Charmed:{name:"Charmed",roll:17,description:"Leader's unit may not be targeted by enemy spells.",short:"Leader's unit may not be targeted by enemy spells."},"18/00 Strength!":{name:"18/00 Strength!",roll:18,description:"During Attacks (whether attacking or defending), Leader's unit may reroll up to three failed hit dice.",short:"During Attacks, Leader's unit may reroll up to three failed hit dice."}},Cs={Unit:{name:"Unit",type:"foot",points:0,stats:{attack:0,move:0,shoot:0,courage:0,armor:0,attackValue:0,defenceValue:0,shootValue:0,shootRange:0,movement:0,strengthPoints:0},rules:[],options:{},fantasticalRules:[]},"Elite Riders":{name:"Elite Riders",type:"mounted",points:6,stats:{attack:5,move:7,shoot:0,courage:3,armor:4,attackValue:3,defenceValue:5,shootValue:0,shootRange:0,movement:10,strengthPoints:6},rules:["Wild Charge","Counter-charge"],options:{"Mounted missiles":{name:"Mounted missiles",points:2,description:'Wild Charge and Counter-charge are removed and replaced with Shoot 6+/Range 12" hitting on 5+.',short:'Shoot 6+, shoot value 5+/12". Remove Wild Charge, Counter-charge',remove:["Wild Charge","Counter-charge"],setStats:{shoot:6,shootValue:5,shootRange:12}},"Level Headed":{name:"Level Headed",points:2,description:"Remove Wild Charge and change Move to 5+.",short:"Remove Wild Charge, Move 5+.",remove:["Wild Charge"],setStats:{move:5}}},fantasticalRules:[]},"Heavy Riders":{name:"Heavy Riders",type:"mounted",points:4,stats:{attack:5,move:5,shoot:0,courage:4,armor:3,attackValue:4,defenceValue:5,shootValue:0,shootRange:0,movement:10,strengthPoints:6},rules:["Counter-charge"],options:{"Mounted missiles":{name:"Mounted missiles",points:1,description:'Add Shoot 6+/Range 12" hitting on 5+.',short:'Shoot 6+, shoot value 5+/12".',setStats:{shoot:6,shootValue:5,shootRange:12}},Chariots:{name:"Chariots",points:2,description:"May not enter rough terrain. armor is increased to 4.",short:"Can't enter rough terrain, armor 4.",add:["Chariots"],setStats:{armor:4}}},fantasticalRules:[]},"Light Riders":{name:"Light Riders",type:"mounted",points:4,stats:{attack:7,move:5,shoot:6,courage:5,armor:3,attackValue:5,defenceValue:6,shootValue:5,shootRange:12,movement:12,strengthPoints:6},rules:["Skirmish","Evade"],options:{"Short range missiles":{name:"Short range missiles",points:-1,description:'Range reduced to 6".',short:'Range reduced to 6".',setStats:{shootRange:6}}},fantasticalRules:[]},"Greater Warbeasts":{name:"Greater Warbeasts",type:"mounted",points:6,stats:{attack:5,move:6,shoot:0,courage:3,armor:4,attackValue:3,defenceValue:6,shootValue:0,shootRange:0,movement:10,strengthPoints:6},rules:["Ranger","Wild Charge"],options:{"Flame or Spore Attack":{name:"Flame or Spore Attack",points:2,description:'Wild Charge is removed and replaced with Shoot 6+/Range 12" hitting on 5+.',short:'Shoot 6+, shoot value 5+/12", remove Wild Charge',setStats:{shoot:6,shootValue:5,shootRange:12},remove:["Wild Charge"]},Ponderous:{name:"Ponderous",points:1,description:"Remove Wild Charge.",short:"Remove Wild Charge.",remove:["Wild Charge"]},Cunning:{name:"Cunning",points:2,description:"Defence Value becomes 5+.",short:"Defence Value 5+.",setStats:{defenceValue:5}}},fantasticalRules:[]},"Lesser Warbeasts":{name:"Lesser Warbeasts",type:"mounted",points:4,stats:{attack:5,move:6,shoot:0,courage:4,armor:3,attackValue:4,defenceValue:6,shootValue:0,shootRange:0,movement:12,strengthPoints:6},rules:["Ranger","Wild Charge","Fleet Footed"],options:{"Flame or Spore Attack":{name:"Flame or Spore Attack",points:2,description:'Wild Charge is removed and replaced with Shoot 6+/Range 12" hitting on 5+.',short:'Shoot 6+, shoot value 5+/12", remove Wild Charge',setStats:{shoot:6,shootValue:5,shootRange:12},remove:["Wild Charge"]},Cunning:{name:"Cunning",points:2,description:"Defence Value becomes 5+.",short:"Defence Value 5+.",setStats:{defenceValue:5}}},fantasticalRules:[]},"Elite Foot":{name:"Elite Foot",type:"foot",points:6,stats:{attack:5,move:5,shoot:0,courage:3,armor:4,attackValue:3,defenceValue:4,shootValue:0,shootRange:0,movement:6,strengthPoints:6},rules:["Ranger"],options:{Missiles:{name:"Missiles",points:2,description:'Add Shoot 6+/Range 18" hitting on 5+.',short:'Shoot 6+, shoot value 5+/18".',setStats:{shoot:6,shootValue:5,shootRange:18}}},fantasticalRules:[]},"Heavy Foot":{name:"Heavy Foot",type:"foot",points:4,stats:{attack:6,move:5,shoot:0,courage:4,armor:3,attackValue:5,defenceValue:4,shootValue:0,shootRange:0,movement:6,strengthPoints:12},rules:["Wall of Spears"],options:{Offensive:{name:"Offensive",points:2,description:"Attack Value becomes 4+. The unit may no longer form a Wall of Spears.",short:"Attack Value 4+. Remove Wall of Spears.",setStats:{attackValue:4},remove:["Wall of Spears"]}},fantasticalRules:[]},"Light Foot":{name:"Light Foot",type:"foot",points:3,stats:{attack:6,move:5,shoot:0,courage:4,armor:2,attackValue:5,defenceValue:4,shootValue:0,shootRange:0,movement:8,strengthPoints:12},rules:["Wall of Spears"],options:{Offensive:{name:"Offensive",points:2,description:"Attack Value becomes 4+. The unit may no longer form a Wall of Spears.",short:"Attack Value 4+. Remove Wall of Spears.",setStats:{attackValue:4},remove:["Wall of Spears"]},"Short range missiles":{name:"Short range missiles",points:1,description:'Shoot 6+/Range 6" hitting on 5+.',short:'Shoot 6+, shoot value 5+/6".',setStats:{shoot:6,shootValue:5,shootRange:6}},"Mixed Weapons":{name:"Mixed Weapons",points:2,description:'Shoot 6+, Range 12" hitting on 5+. Remove Wall of Spears.',short:'Shoot 6+, shoot value 5+/6". Remove Wall of Spears.',setStats:{shoot:6,shootValue:5,shootRange:12},remove:["Wall of Spears"]}},fantasticalRules:[]},"Bellicose Foot":{name:"Bellicose Foot",type:"foot",points:4,stats:{attack:5,move:6,shoot:0,courage:4,armor:2,attackValue:3,defenceValue:6,shootValue:0,shootRange:0,movement:8,strengthPoints:12},rules:["Ranger","Wild Charge","Counter-charge vs. foot","Fleet Footed"],options:{"Terrifically Shiny armor":{name:"Terrifically Shiny armor",points:2,description:"Armor becomes 3.",short:"Armor 3.",setStats:{armor:3}}},fantasticalRules:[]},"Heavy Missiles":{name:"Heavy Missiles",type:"foot",points:4,stats:{attack:7,move:6,shoot:7,courage:4,armor:2,attackValue:6,defenceValue:5,shootValue:4,shootRange:18,movement:6,strengthPoints:12},rules:[],options:{"Weighty Projectiles":{name:"Weighty Projectiles",points:-1,description:'Range reduced to 12".',short:'Range reduced to 12".',setStats:{shootRange:12}}},fantasticalRules:[]},"Light Missiles":{name:"Light Missiles",type:"foot",points:4,stats:{attack:7,move:6,shoot:6,courage:4,armor:2,attackValue:6,defenceValue:5,shootValue:5,shootRange:18,movement:6,strengthPoints:12},rules:[],options:{Sharpshooter:{name:"Sharpshooter",points:2,description:"Shoot Value becomes 4+.",short:"Shoot Value 4+.",setStats:{shootValue:4}}},fantasticalRules:[]},Scouts:{name:"Scouts",type:"foot",points:2,stats:{attack:7,move:5,shoot:7,courage:5,armor:1,attackValue:6,defenceValue:6,shootValue:5,shootRange:12,movement:8,strengthPoints:6},rules:["Hard to target","Skirmish","Evade","Fleet Footed"],options:{},fantasticalRules:[]},"Ravenous Hordes":{name:"Ravenous Hordes",type:"foot",points:1,stats:{attack:7,move:6,shoot:0,courage:5,armor:1,attackValue:6,defenceValue:6,shootValue:0,shootRange:0,movement:6,strengthPoints:12},rules:[],options:{},fantasticalRules:[]}},Yt=ve.createInstance({driver:ve.LOCALSTORAGE}),te=ve.createInstance({name:"xrabDB",storeName:"rosterStore"}),Je=ve.createInstance({name:"xrabDB",storeName:"dataStore"}),ye=()=>({unitData:{},fantasticalRulesData:{},rulesData:{},spells:{}}),oe={unitData:Cs,fantasticalRulesData:bs,rulesData:Ss,spells:Rs,traits:ks,customData:ye()},Jt=cs("data/hydrateData",async()=>{const t=await Je.getItem("data");return t!==null?t:null}),Zt=De({name:"data",initialState:oe,reducers:{_setData:(t,s)=>({...s.payload})},extraReducers:t=>{t.addCase(Jt.fulfilled,(s,n)=>{const a=n.payload;return a===null?s:{unitData:{...oe.unitData,...a.unitData},fantasticalRulesData:{...oe.fantasticalRulesData,...a.fantasticalRulesData},rulesData:{...oe.rulesData,...a.rulesData},spells:{...oe.spells,...a.spells},traits:{...oe.traits},customData:a}})}}),{_setData:Qt}=Zt.actions,Xt=me([t=>t.data.unitData],t=>Object.keys(t).slice(1)),Kt=me([t=>t.data.rulesData,t=>t.data.fantasticalRulesData],(t,s)=>({...t,...s})),Ze=t=>(s,n)=>{const a=re(n().data,o=>{Object.keys(t).forEach(r=>{Object.values(t[r]).forEach(c=>{o[r][c.name]=c,o.customData[r][c.name]=c})})});Je.setItem("data",a.customData).catch(o=>console.log(o)),s(Qt(a))},Me=t=>s=>{const n=ye();return n[t][s.name]=s,Ze(n)},$e=t=>s=>(n,a)=>{const o=re(a().data,r=>{delete r[t][s],delete r.customData[t][s]});Je.setItem("data",o.customData).catch(r=>console.log(r)),n(Qt(o))},_s=Me("unitData"),ws=$e("unitData"),As=Me("fantasticalRulesData"),Ds=$e("fantasticalRulesData"),Ms=Me("spells"),$s=$e("spells"),Os=Me("rulesData"),Ps=$e("rulesData"),Is=Zt.reducer;var Qe={},We={};const Fs=rs(Ha);var Lt;function v(){return Lt||(Lt=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.createSvgIcon}});var s=Fs}(We)),We}var Vs=g;Object.defineProperty(Qe,"__esModule",{value:!0});var Xe=Qe.default=void 0,Ws=Vs(v()),Ls=e,Ts=(0,Ws.default)((0,Ls.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");Xe=Qe.default=Ts;var Ke={},zs=g;Object.defineProperty(Ke,"__esModule",{value:!0});var ea=Ke.default=void 0,Es=zs(v()),Hs=e,Us=(0,Es.default)((0,Hs.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");ea=Ke.default=Us;var et={},Bs=g;Object.defineProperty(et,"__esModule",{value:!0});var ta=et.default=void 0,Ns=Bs(v()),qs=e,Gs=(0,Ns.default)((0,qs.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility");ta=et.default=Gs;const Tt={name:"New List",units:[]},tt=De({name:"roster",initialState:Tt,reducers:{newRoster:()=>({...Tt}),setRoster:(t,s)=>({...s.payload}),updateRoster:(t,s)=>({...t,...s.payload}),_addUnit:(t,s)=>{let[n,a,o]=s.payload;a=a||{...n.unitData.Unit,options:[],fantasticalRules:[]},o==null?t.units.push(a):t.units.splice(o+1,0,a)},_setUnit:(t,s)=>{const[n,a,o]=s.payload;t.units[a]={...n.unitData[o],options:[],fantasticalRules:[]}},updateUnit:{reducer:(t,s)=>{const[n,a]=s.payload;t.units[n]={...t.units[n],...a}},prepare:(t,s)=>({payload:[t,s]})},removeUnit:(t,s)=>{const n=s.payload;t.units.splice(n,1)},renameUnit:{reducer:(t,s)=>{const[n,a]=s.payload;t.units[n].customName=a},prepare:(t,s)=>({payload:[t,s]})},moveUnit:{reducer:(t,s)=>{const[n,a]=s.payload,o=a==="left"?n-1:n+1;if(o<0||o>=t.units.length)return t;[t.units[o],t.units[n]]=[t.units[n],t.units[o]]},prepare:(t,s)=>({payload:[t,s]})}}}),{_addUnit:Ys,_setUnit:Js}=tt.actions,aa=(t,s)=>(n,a)=>{const o=a().data;n(Ys([o,t,s]))},Zs=(t,s)=>(n,a)=>{const o=a().data;n(Js([o,t,s]))},sa=me(t=>t,t=>Object.values(t).reduce((s,n)=>s+n.points,0)),Qs=me(t=>t.roster.units,t=>Kt(t),(t,s)=>{const n=new Set;return t.forEach(a=>a.rules.forEach(o=>n.add(o))),[...n].sort().reduce((a,o)=>s[o]?{...a,[o]:s[o]}:a,{})}),Xs=me(t=>t.roster.units,t=>t.data.spells,(t,s)=>{if(t.some(a=>a.fantasticalRules.includes("Spellcaster")))return s;const n=new Set;return t.forEach(a=>{var o;return(o=a.spells)==null?void 0:o.forEach(r=>n.add(r))}),[...n].sort().reduce((a,o)=>({...a,[o]:s[o]}),{})}),{newRoster:Ks,setRoster:na,updateRoster:en,updateUnit:tn,removeUnit:an,renameUnit:sn,moveUnit:zt}=tt.actions,nn=tt.reducer;var at={},on=g;Object.defineProperty(at,"__esModule",{value:!0});var oa=at.default=void 0,rn=on(v()),ln=e,cn=(0,rn.default)((0,ln.jsx)("path",{d:"M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"}),"FormatIndentIncrease");oa=at.default=cn;const dn=()=>{try{const t=localStorage.getItem("localforage/uiOptions");if(t!==null)return JSON.parse(t)}catch(t){console.log(t)}return{viewMode:!1,editMode:!1,inlineRules:!0,darkMode:null,validationExpanded:!0,rulesSummaryExpanded:!0,campaignExpanded:!1,powersExpanded:!1,statisticsExpanded:!0}},ra=De({name:"ui",initialState:dn(),reducers:{_setUI:(t,s)=>({...s.payload}),_toggleUIOption:(t,s)=>{const n=s.payload;t[n]=!t[n]},_updateUI:(t,s)=>({...t,...s.payload})}}),{_setUI:Ui,_toggleUIOption:un,_updateUI:hn}=ra.actions,Oe=t=>(s,n)=>{const a=n().ui;Yt.setItem("uiOptions",{...a,[t]:!a[t]}).catch(o=>console.log(o)),s(un(t))},ze=t=>(s,n)=>{const a=n().ui;Yt.setItem("uiOptions",{...a,...t}).catch(o=>console.log(o)),s(hn(t))},mn=ra.reducer,J=({text:t,icon:s,showText:n,action:a,enabled:o=!0,children:r})=>e.jsxs(e.Fragment,{children:[e.jsxs(b,{display:"flex",alignItems:"center",onClick:a,children:[e.jsx(M,{title:t,children:e.jsx(L,{color:o?"inherit":"default","aria-label":t,size:"large",children:s})}),n&&e.jsx(x,{color:o?"inherit":"textSecondary",children:t})]}),r]}),pn=({showText:t})=>{const s=p(o=>o.ui.inlineRules),n=j(),a=()=>{n(Oe("inlineRules"))};return e.jsx(J,{text:"Inline rules",action:a,icon:e.jsx(oa,{}),showText:t,enabled:s})},ia=y.memo(pn);var st={},fn=g;Object.defineProperty(st,"__esModule",{value:!0});var la=st.default=void 0,xn=fn(v()),gn=e,vn=(0,xn.default)((0,gn.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"}),"SaveOutlined");la=st.default=vn;const ca=De({name:"appState",initialState:{feedback:{open:!1,message:"",severity:"info"},inputUpdate:!1,customizeMode:!1},reducers:{toggleForceInputUpdate:t=>{t.inputUpdate=!t.inputUpdate},closeFeedback:t=>{t.feedback.open=!1},showFeedback:{reducer:(t,s)=>{const[n,a]=s.payload;t.feedback={open:!0,message:n,severity:a}},prepare:(t,s)=>({payload:[t,s]})},setCustomizeMode:(t,s)=>{t.customizeMode=s.payload}}}),{toggleForceInputUpdate:nt,closeFeedback:yn,showFeedback:_,setCustomizeMode:da}=ca.actions,jn=ca.reducer,Y=(t=!1,s,n)=>{const[a,o]=y.useState(t);return[a,()=>{o(!0),s&&s()},()=>{n&&n(),o(!1)}]},Pe=({anchor:t,action:s,options:n,title:a,onClose:o,onOpen:r})=>{const[c,l,i]=Y(!1,r,o),d=m=>{s(m),i()},u=typeof n[0]=="string"?n.map(m=>[m,null]):n;return e.jsxs(e.Fragment,{children:[e.jsx(b,{display:"flex",alignItems:"center",onClick:l,children:t}),e.jsxs(E,{onClose:i,open:c,children:[e.jsx(H,{children:a}),e.jsx(U,{children:e.jsx(z,{children:u.map(([m,h])=>e.jsxs(V,{onClick:()=>d(m),children:[h&&e.jsx(He,{children:h}),m]},m))})})]})]})};var ot={},bn=g;Object.defineProperty(ot,"__esModule",{value:!0});var ua=ot.default=void 0,Sn=bn(v()),Rn=e,kn=(0,Sn.default)((0,Rn.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");ua=ot.default=kn;var rt={},Cn=g;Object.defineProperty(rt,"__esModule",{value:!0});var ha=rt.default=void 0,_n=Cn(v()),wn=e,An=(0,_n.default)((0,wn.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");ha=rt.default=An;var it={},Dn=g;Object.defineProperty(it,"__esModule",{value:!0});var ie=it.default=void 0,Mn=Dn(v()),$n=e,On=(0,Mn.default)((0,$n.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");ie=it.default=On;const Pn=({expanded:t,onClick:s})=>e.jsx(L,{sx:t?{transform:"rotate(180deg)"}:{transform:"rotate(0deg)",marginLeft:"auto"},onClick:s,size:"large",children:e.jsx(ie,{})}),In=y.memo(Pn);var lt={},Fn=g;Object.defineProperty(lt,"__esModule",{value:!0});var ma=lt.default=void 0,Vn=Fn(v()),Wn=e,Ln=(0,Vn.default)((0,Wn.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore");ma=lt.default=Ln;var ct={},Tn=g;Object.defineProperty(ct,"__esModule",{value:!0});var pa=ct.default=void 0,zn=Tn(v()),En=e,Hn=(0,zn.default)((0,En.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");pa=ct.default=Hn;var dt={},Un=g;Object.defineProperty(dt,"__esModule",{value:!0});var fa=dt.default=void 0,Bn=Un(v()),Nn=e,qn=(0,Bn.default)((0,Nn.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0-6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm0 8c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm-6 4c.22-.72 3.31-2 6-2 2.7 0 5.8 1.29 6 2H9zm-3-3v-3h3v-2H6V7H4v3H1v2h3v3z"}),"PersonAddOutlined");fa=dt.default=qn;var ut={},Gn=g;Object.defineProperty(ut,"__esModule",{value:!0});var xa=ut.default=void 0,Yn=Gn(v()),Jn=e,Zn=(0,Yn.default)((0,Jn.jsx)("path",{d:"M2.5 4v3h5v12h3V7h5V4h-13zm19 5h-9v3h3v7h3v-7h3V9z"}),"TextFields");xa=ut.default=Zn;const ga=({anchor:t,action:s,title:n="",label:a="",defaultValue:o="",cancelText:r="Cancel",okayText:c="Okay",margin:l="dense",onClose:i,onOpen:d})=>{const[u,m,h]=Y(!1,d,i),[f,R]=y.useState(""),w=C=>{C==="Enter"?(s(f),h()):C==="ESC"&&h()},Z=()=>{s(f),h()};return e.jsxs(e.Fragment,{children:[e.jsx(b,{display:"flex",alignItems:"center",onClick:m,children:t}),e.jsxs(E,{onClose:h,open:u,children:[e.jsx(H,{children:n}),e.jsx(U,{children:e.jsx(Re,{variant:"standard",autoFocus:!0,margin:l,label:a,type:"text",fullWidth:!0,defaultValue:o||f,onChange:C=>R(C.target.value),onKeyPress:C=>w(C.key)})}),e.jsxs(Q,{children:[e.jsx(k,{onClick:h,color:"primary",children:r}),e.jsx(k,{onClick:Z,disabled:!f,color:"primary",children:c})]})]})]})},Qn=({id:t,unit:s})=>{const n=j(),a=()=>n(zt(t,"left")),o=()=>n(zt(t,"right")),r=()=>n(aa(s,t)),c=l=>n(sn(t,l));return e.jsx(b,{sx:{position:"absolute",bottom:5,width:"95%",pr:2},children:e.jsxs(b,{display:"flex",sx:{height:25},children:[e.jsxs(b,{display:"flex",alignItems:"center",children:[e.jsx(M,{title:"Move back",children:e.jsx(L,{onClick:a,size:"large",children:e.jsx(ma,{})})}),e.jsx(M,{title:"Move forward",children:e.jsx(L,{onClick:o,size:"large",children:e.jsx(pa,{})})})]}),e.jsx(b,{flexGrow:1}),e.jsxs(b,{display:"flex",alignItems:"center",children:[e.jsx(ga,{anchor:e.jsx(M,{title:"Rename unit",children:e.jsx(L,{size:"large",children:e.jsx(xa,{})})}),action:c,title:"Enter the name for the unit",label:"Unit name",defaultValue:s.customName,okayText:"Rename"}),e.jsx(M,{title:"Clone unit",children:e.jsx(L,{onClick:r,size:"large",children:e.jsx(fa,{})})})]})]})})};var ht={},Xn=g;Object.defineProperty(ht,"__esModule",{value:!0});var le=ht.default=void 0,Kn=Xn(v()),eo=e,to=(0,Kn.default)((0,eo.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown");le=ht.default=to;const ao=({unit:t,onChange:s})=>{const[n,a,o]=Y(),r=p(d=>d.data.fantasticalRulesData),c=p(d=>d.ui.inlineRules);if(t.name==="Unit")return e.jsx("div",{});const l=Object.keys(r).filter(d=>!r[d].exclude_units.includes(t.name)),i=d=>s({...t,fantasticalRules:[...d.target.value]});return e.jsxs(e.Fragment,{children:[e.jsxs(de,{onClick:a,component:"legend",children:["Fantastical Rules",e.jsx(le,{sx:{pt:"5px"}})]}),t.fantasticalRules&&t.fantasticalRules.length>0&&t.fantasticalRules.map(d=>e.jsx("div",{children:e.jsx(Ue,{control:e.jsx(Be,{checked:!0,onChange:()=>s({...t,fantasticalRules:[...t.fantasticalRules.filter(u=>u!==d)]})}),label:e.jsx(M,{title:r[d].description,children:e.jsxs(x,{children:[d," ",e.jsxs(x,{color:"secondary",component:"span",children:["@",r[d].points]})]})})},d)},d)),e.jsx(se,{variant:"standard",sx:{mt:0,width:0,height:0},children:e.jsx(ue,{variant:"standard",open:n,onClose:o,onOpen:a,IconComponent:()=>e.jsx(b,{}),multiple:!0,value:t.fantasticalRules,onChange:i,input:e.jsx(ke,{}),renderValue:()=>" ",children:l.map(d=>{var u;return e.jsx(ne,{value:d,dense:!0,sx:{maxWidth:400},children:e.jsx(M,{title:r[d].description,children:e.jsx(P,{primary:e.jsxs(x,{variant:"body2",color:t.fantasticalRules.indexOf(d)>-1?"primary":"inherit",children:[d," ",e.jsxs(x,{color:"secondary",component:"span",variant:"body2",children:["@",r[d].points]})]}),secondary:c&&((u=r[d])==null?void 0:u.short)||"",secondaryTypographyProps:{sx:{whiteSpace:"normal"}},sx:{m:0}})})},d)})})})]})},so=({unit:t,onChange:s})=>{const[n,a,o]=Y(),r=p(i=>i.data.unitData[t.name].options),c=p(i=>i.ui.inlineRules);if(!r||!Object.keys(r).length)return e.jsx("div",{});const l=i=>s({...t,options:[...i.target.value]});return e.jsxs(e.Fragment,{children:[e.jsxs(de,{onClick:a,component:"legend",children:["Options",e.jsx(le,{sx:{pt:"5px"}})]}),t.options.map(i=>e.jsx("div",{children:e.jsx(Ue,{control:e.jsx(Be,{checked:!0,onChange:()=>s({...t,options:[...t.options.filter(d=>d!==i)]})}),label:e.jsx(M,{title:r[i].description,children:e.jsxs(x,{children:[i," ",e.jsxs(x,{color:"secondary",component:"span",children:["@",r[i].points]})]})})},i)},i)),e.jsx(se,{variant:"standard",sx:{m:0,width:0,height:0},children:e.jsx(ue,{variant:"standard",open:n,onClose:o,onOpen:a,IconComponent:()=>e.jsx(b,{}),multiple:!0,value:t.options,onChange:l,input:e.jsx(ke,{}),renderValue:()=>" ",children:Object.keys(r).map(i=>{var d,u,m;return e.jsx(ne,{value:i,dense:!0,sx:{maxWidth:380},disabled:((d=r[i].disabledBy)==null?void 0:d.some(h=>t.options.includes(h)))||r[i].enabledBy&&!((u=r[i].enabledBy)!=null&&u.some(h=>t.options.includes(h))),children:e.jsx(M,{title:r[i].description,children:e.jsx(P,{primary:e.jsxs(x,{variant:"body2",color:t.options.indexOf(i)>-1?"primary":"inherit",children:[i," ",e.jsxs(x,{color:"secondary",variant:"body2",component:"span",children:["@",r[i].points]})]}),secondary:c&&((m=r[i])==null?void 0:m.short)||"",secondaryTypographyProps:{sx:{whiteSpace:"normal"}},sx:{m:0}})})},i)})})})]})},no=({rules:t})=>{const s=p(a=>Kt(a)),n=p(a=>a.ui.inlineRules);return t&&t.length?e.jsxs(he,{children:[e.jsx(x,{variant:"h4",children:"Special Rules"}),e.jsx(z,{dense:!0,children:t.map(a=>{var o,r;return e.jsx(M,{title:((o=s[a])==null?void 0:o.description)||"",children:e.jsx(F,{children:e.jsx(P,{primary:a,secondary:n&&((r=s[a])==null?void 0:r.short)||"",primaryTypographyProps:{variant:"body2"},sx:{m:0}})},a)},a)})})]}):e.jsx(e.Fragment,{})},oo=({unit:t,onChange:s})=>{const[n,a,o]=Y(),r=p(u=>u.data.spells),c=p(u=>u.ui.inlineRules),l=p(u=>u.ui.viewMode),i=p(u=>u.ui.editMode);if(!t.fantasticalRules.some(u=>u==="Wizardlings"))return e.jsx("div",{});const d=u=>s({...t,spells:[...u.target.value]});return e.jsxs(b,{marginBottom:"-20px",children:[!l&&e.jsxs(de,{onClick:a,component:"legend",children:["Spells",e.jsx(le,{sx:{pt:"5px"}})]}),e.jsxs(he,{sx:{mb:0},children:[l&&e.jsx(x,{variant:"h4",children:"Spells"}),t.spells&&e.jsx(z,{dense:!0,children:e.jsx(b,{marginLeft:c?"inherit":"1rem",children:t.spells.map((u,m,h)=>{var f,R;return e.jsx(M,{title:((f=r[u])==null?void 0:f.effect)||"",children:t.spells&&!i&&c?e.jsx(F,{children:e.jsx(P,{primary:u,secondary:((R=r[u])==null?void 0:R.short)||"",primaryTypographyProps:{variant:"body2"},sx:{m:0}})},u):e.jsxs(x,{variant:"inherit",children:[u,m===h.length-1?"":", "]},u)},u)})})})]}),e.jsx(se,{variant:"standard",sx:{mt:1,width:0,height:0},children:e.jsx(ue,{variant:"standard",open:n,onClose:o,onOpen:a,IconComponent:()=>e.jsx(b,{}),multiple:!0,value:t.spells,onChange:d,input:e.jsx(ke,{}),renderValue:()=>" ",children:Object.keys(r).map(u=>{var m;return e.jsx(ne,{value:u,dense:!0,sx:{maxWidth:400},children:e.jsx(M,{title:r[u].effect,children:e.jsx(P,{primary:u,secondary:c&&((m=r[u])==null?void 0:m.short)||"",primaryTypographyProps:{color:t.spells&&t.spells.indexOf(u)>-1?"primary":"inherit"},secondaryTypographyProps:{sx:{whiteSpace:"normal"}},sx:{m:0}})})},u)})})})]})},D=(t,s)=>Array(s+1-t).fill(t).map((n,a)=>n+a),ee={attack:{name:"Attack",shortName:"A",range:D(0,12),adjustRange:D(-12,12),suffix:"+"},attackValue:{name:"Attack Value",shortName:"AV",range:D(0,6),adjustRange:D(-6,6),suffix:"+"},move:{name:"Move",shortName:"M",range:D(0,12),adjustRange:D(-12,12),suffix:"+"},defenceValue:{name:"Defence Value",shortName:"DV",range:D(0,6),adjustRange:D(-6,6),suffix:"+"},shoot:{name:"Shoot",shortName:"S",range:[0,2,3,4,5,6,7,8,9,10,11,12],adjustRange:D(-12,12),suffix:"+"},shootValue:{name:"Shoot Value",shortName:"SV",range:[0,2,3,4,5,6],adjustRange:D(-6,6),suffix:"+"},courage:{name:"Courage",shortName:"C",range:D(0,12),adjustRange:D(-12,12),suffix:"+"},shootRange:{name:"Shooting Range",shortName:"SR",range:[0,6,12,18,24],adjustRange:[-24,-18,-12,-6,0,6,12,18,24],suffix:""},armor:{name:"Armor",shortName:"Ar",range:D(0,6),adjustRange:D(-6,6),suffix:""},movement:{name:"Movement",shortName:"MR",range:[0,2,4,6,8,10,12,14,16,18],adjustRange:[-18,-16,-14,-12,-10,-8,-6,-4,-2,2,4,6,8,10,12,14,16,18],suffix:'"'},strengthPoints:{name:"Strength Points",shortName:"SP",range:[6,12],adjustRange:[-12,-6,6,12],suffix:""}},N=({stat:t,stats:s,isPhone:n,overrideValue:a})=>{const o=ee[t],r=a||(s[t]?s[t]+o.suffix:"-");return e.jsxs(e.Fragment,{children:[e.jsx(O,{children:n?o.shortName:o.name}),e.jsx(O,{children:r})]})},ro=({stats:t})=>{const s=Ht(),n=Se(s.breakpoints.down("sm")),a={stats:t,isPhone:n},o=t.shoot?`${t.shootValue}+/${t.shootRange}"`:"-";return e.jsx(Ne,{sx:{mb:2},children:e.jsx(qe,{size:"small",children:e.jsxs(Ge,{children:[e.jsxs(W,{children:[e.jsx(N,{stat:"attack",...a}),e.jsx(N,{stat:"attackValue",...a})]}),e.jsxs(W,{children:[e.jsx(N,{stat:"move",...a}),e.jsx(N,{stat:"defenceValue",...a})]}),e.jsxs(W,{children:[e.jsx(N,{stat:"shoot",...a}),e.jsx(N,{stat:"shootValue",overrideValue:o,...a})]}),e.jsxs(W,{children:[e.jsx(N,{stat:"courage",...a}),e.jsx(N,{stat:"movement",...a})]}),e.jsxs(W,{children:[e.jsx(N,{stat:"armor",...a}),e.jsx(N,{stat:"strengthPoints",...a})]})]})})})},io=({unit:t,onChange:s})=>{var d,u;const[n,a,o]=Y(),r=p(m=>m.data.traits),c=p(m=>m.ui.inlineRules),l=p(m=>m.ui.viewMode);if(!t.fantasticalRules.some(m=>m==="Leader"))return e.jsx("div",{});const i=m=>s({...t,trait:m.target.value});return e.jsxs(b,{marginBottom:"-20px",children:[!l&&e.jsxs(de,{onClick:a,component:"legend",children:["Trait",e.jsx(le,{sx:{pt:"5px"}})]}),e.jsxs(he,{sx:{mb:0},children:[l&&e.jsx(x,{variant:"h4",children:"Trait"}),t.trait&&e.jsx(z,{dense:!0,children:e.jsx(b,{marginLeft:c?"inherit":"1rem",children:e.jsx(M,{title:((d=r[t.trait])==null?void 0:d.description)||"",children:e.jsx(F,{children:e.jsx(P,{primary:t.trait,secondary:c&&((u=r[t.trait])==null?void 0:u.short)||"",primaryTypographyProps:{variant:"body2"},sx:{m:0}})},t.trait)},t.trait)})})]}),e.jsx(se,{variant:"standard",sx:{mt:1,width:0,height:0},children:e.jsx(ue,{variant:"standard",open:n,onClose:o,onOpen:a,IconComponent:()=>e.jsx(b,{}),value:t.trait||"",onChange:i,input:e.jsx(ke,{}),renderValue:()=>" ",children:Object.keys(r).map(m=>{var h;return e.jsx(ne,{value:m,dense:!0,sx:{maxWidth:400},children:e.jsx(M,{title:r[m].description,children:e.jsx(P,{primary:r[m].roll+": "+m,secondary:c&&((h=r[m])==null?void 0:h.short)||"",secondaryTypographyProps:{sx:{whiteSpace:"normal"}},sx:{m:0}})})},m)})})})]})},lo=({unit:t,id:s})=>{const n=p(c=>Xt(c)),a=j(),o=t.customName?t.customName:t.name,r=c=>{c!==t.name&&a(Zs(s,c))};return e.jsx(Pe,{action:r,anchor:e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"h3",children:[e.jsx(ce,{label:t.points,color:"primary"}),"  ",o,e.jsx(le,{})]}),t.customName&&e.jsx(x,{sx:{ml:"-105px",mb:-7},children:t.name})]}),options:n,title:"Choose unit type"})},co=ds({ui:mn,roster:nn,appState:jn,data:Is}),Ee=us({reducer:co}),va=t=>{const s=Ee.getState().data.unitData[t.name],n=Ee.getState().data.fantasticalRulesData;let a={...s,customName:t.customName||"",options:[...t.options],fantasticalRules:[...t.fantasticalRules],spells:t.spells||[],trait:t.trait},o=s.points,r={};for(const c of a.options){const l=s.options[c];if(o+=l.points||0,l.setStats)for(const[i,d]of Object.entries(l.setStats))a={...a,stats:{...a.stats,[i]:d}};if(l.adjustStats&&(r={...r,...l.adjustStats}),l.add)for(const i of l.add)a.rules=[...a.rules,i];if(l.remove)for(const i of l.remove)a.rules=a.rules.filter(d=>d!==i)}for(const c of a.fantasticalRules){const l=n[c];if(o+=l.points,a.rules=[...a.rules,l.name],l.setStats)for(const[i,d]of Object.entries(l.setStats))a={...a,stats:{...a.stats,[i]:d}};l.adjustStats&&(r={...r,...l.adjustStats})}for(const[c,l]of Object.entries(r)){const i=c,d=a.stats[i];l&&typeof l=="number"&&typeof d=="number"&&(a={...a,stats:{...a.stats,[c]:d+l}})}return a.fantasticalRules.some(c=>c==="Wizardlings")||(a={...a,spells:[]}),a.fantasticalRules.some(c=>c==="Leader")||(a={...a,trait:void 0}),a.rules.length>0&&(a={...a,rules:[...a.rules].sort()}),a={...a,points:o},a},uo=({id:t})=>{const s=j(),n=p(u=>u.roster.units[t]),a=p(u=>u.ui.viewMode),o=p(u=>u.ui.editMode),[r,c]=y.useState(!0),l=()=>c(!r),i=u=>{u=va(u),s(tn(t,{...u}))},d=()=>s(an(t));return e.jsxs(Ua,{sx:{mb:3,maxWidth:380,width:"100%",position:"relative"},children:[a?e.jsx(Ft,{title:e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"h3",children:[e.jsx(ce,{label:n.points,color:"primary"}),"  ",n.customName?n.customName:n.name]}),n.customName&&(r?e.jsx(x,{sx:{ml:"45px",mb:-3},children:n.name}):e.jsx(x,{sx:{ml:"45px"},children:n.name}))]}),action:e.jsx(In,{expanded:r,onClick:l})}):e.jsx(Ft,{title:e.jsx(lo,{unit:n,id:t}),action:e.jsx(k,{onClick:d,children:e.jsx(ha,{})})}),e.jsx(Ut,{in:!a||r,timeout:"auto",unmountOnExit:!0,children:e.jsxs(Ba,{children:[!o&&e.jsxs(e.Fragment,{children:[e.jsx(ro,{stats:n.stats}),e.jsx(no,{rules:n.rules})]}),e.jsx(io,{onChange:i,unit:n}),e.jsx(oo,{onChange:i,unit:n}),!a&&e.jsxs(e.Fragment,{children:[e.jsx(so,{onChange:i,unit:n}),e.jsx(ao,{onChange:i,unit:n}),e.jsx(Qn,{id:t,unit:n})]})]})})]})},ho=y.memo(uo),ya=t=>{const s=t.units.map(n=>{const a={name:n.name,options:n.options,fantasticalRules:n.fantasticalRules};return n.customName&&(a.customName=n.customName),n.trait&&(a.trait=n.trait),n.spells&&n.spells.length>0&&(a.spells=n.spells),a});return{...t,units:s}},ja=t=>{const s=Object.values(t.units).map(n=>va(n));return{...t,units:s}},mo=()=>{const t=j(),s=p(a=>a.roster),n=p(a=>a.ui.viewMode);return e.jsxs(e.Fragment,{children:[e.jsx(b,{display:"flex",flexDirection:"row",flexWrap:"wrap",children:s.units.map((a,o)=>e.jsx(ho,{id:o},o))}),!Object.keys(s.units).length&&!n&&e.jsx(x,{variant:"h4",sx:{mb:3},children:"Click the button to add your first unit!"}),!n&&e.jsx(Le,{color:"secondary",sx:{ml:3,mb:3},onClick:()=>t(aa()),"aria-label":"Add unit",children:e.jsx(ua,{})})]})},po=({onClose:t,showText:s})=>{const n=j(),[a,o]=G.useState([]),r=()=>te.keys().then(l=>o(l)),c=async l=>{try{const i=await te.getItem(l),d=ja(i);n(na({...d})),n(nt()),n(_(`${l} loaded!`,"success"))}catch{n(_(`Could not load ${l}!`,"error"))}};return e.jsx(Pe,{action:c,anchor:e.jsx(J,{text:"Load List",icon:e.jsx(la,{}),showText:s}),onOpen:r,options:a,title:"Choose List to load",onClose:t})},ba=y.memo(po);var mt={},fo=g;Object.defineProperty(mt,"__esModule",{value:!0});var Sa=mt.default=void 0,xo=fo(v()),go=e,vo=(0,xo.default)((0,go.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");Sa=mt.default=vo;const yo=({onClose:t,showText:s})=>{const n=j(),a=hs(),o=()=>{const r=a.getState().roster;if(r.name==="New List"){n(_("You have to give the list a name!","error"));return}te.setItem(r.name,{...ya(r)}).then(()=>n(_("Saved!","success"))).catch(c=>{console.log(c),n(_("Could not save!","error"))}).finally(()=>{t&&t()})};return e.jsx(J,{text:"Save List",action:o,icon:e.jsx(Sa,{}),showText:s})},Ra=y.memo(yo);var pt={},jo=g;Object.defineProperty(pt,"__esModule",{value:!0});var ka=pt.default=void 0,bo=jo(v()),So=e,Ro=(0,bo.default)((0,So.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");ka=pt.default=Ro;var ft={},ko=g;Object.defineProperty(ft,"__esModule",{value:!0});var Ca=ft.default=void 0;wo(G);var Co=ko(v()),_o=e;function _a(t){if(typeof WeakMap!="function")return null;var s=new WeakMap,n=new WeakMap;return(_a=function(a){return a?n:s})(t)}function wo(t,s){if(!s&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=_a(s);if(n&&n.has(t))return n.get(t);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)){var c=o?Object.getOwnPropertyDescriptor(t,r):null;c&&(c.get||c.set)?Object.defineProperty(a,r,c):a[r]=t[r]}return a.default=t,n&&n.set(t,a),a}var Ao=(0,Co.default)((0,_o.jsx)("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub");Ca=ft.default=Ao;var xt={},Do=g;Object.defineProperty(xt,"__esModule",{value:!0});var wa=xt.default=void 0,Mo=Do(v()),$o=e,Oo=(0,Mo.default)((0,$o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");wa=xt.default=Oo;const Po=({onClose:t=void 0,showText:s=!0})=>{const[n,a,o]=Y(!1,void 0,t);return e.jsx(J,{text:"About",action:a,icon:e.jsx(wa,{}),showText:s,children:e.jsxs(E,{open:n,onClose:o,children:[e.jsx(H,{sx:{textAlign:"center"},children:"About"}),e.jsxs(U,{children:[e.jsxs(x,{variant:"body1",children:["A simple Army Builder for the tabletop game"," ",e.jsx("a",{href:"https://ospreypublishing.com/xenos-rampant",children:"Xenos Rampant"}),"."]}),e.jsxs(b,{display:"flex",sx:{mt:3},children:[e.jsx(ce,{label:"View on Github",icon:e.jsx(Ca,{}),component:"a",href:"https://github.com/dickloraine/xenos-rampant-builder",clickable:!0}),e.jsx(b,{flexGrow:1}),e.jsx(ce,{label:"License: MIT"})]})]})]})})},Io=y.memo(Po);var gt={},Fo=g;Object.defineProperty(gt,"__esModule",{value:!0});var Aa=gt.default=void 0,Vo=Fo(v()),Wo=e,Lo=(0,Vo.default)((0,Wo.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"Backup");Aa=gt.default=Lo;const To=({showText:t=!1,onClose:s=void 0})=>{const n=p(o=>o.data.customData),a=async()=>{const o={rosters:{},customData:n};await te.iterate((d,u)=>{o.rosters[u]=d});const r=new Blob([JSON.stringify(o)],{type:"text/plain;charset=utf-8"});let c=new Date;const l=c.getTimezoneOffset()*60*1e3;c=new Date(c.getTime()-l);const i=c.toISOString().slice(0,10).replace(/-/g,"/");ps.saveAs(r,`${i}_DRAB.sav`),s&&s()};return e.jsx(J,{text:"Backup",action:a,icon:e.jsx(Aa,{}),showText:t})},zo=y.memo(To);var vt={},Eo=g;Object.defineProperty(vt,"__esModule",{value:!0});var Da=vt.default=void 0,Ho=Eo(v()),Uo=e,Bo=(0,Ho.default)((0,Uo.jsx)("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"}),"BrightnessHigh");Da=vt.default=Bo;const No=({showText:t})=>{let s=p(r=>r.ui.darkMode);const n=Se("(prefers-color-scheme: dark)"),a=j();s===null&&(s=n);const o=()=>{a(ze({darkMode:!s}))};return e.jsx(J,{text:"Dark Mode",action:o,icon:e.jsx(Da,{}),showText:t,enabled:s})},qo=y.memo(No);var yt={},Go=g;Object.defineProperty(yt,"__esModule",{value:!0});var Ma=yt.default=void 0,Yo=Go(v()),Jo=e,Zo=(0,Yo.default)((0,Jo.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");Ma=yt.default=Zo;const Qo=({onClose:t,showText:s})=>{const n=j(),[a,o]=G.useState([]),r=()=>te.keys().then(l=>o(l)),c=async l=>{await te.removeItem(l),n(_("Deleted!","success"))};return e.jsx(Pe,{action:c,anchor:e.jsx(J,{text:"Delete List",icon:e.jsx(Ma,{}),showText:s}),onOpen:r,options:a,title:"Choose List to delete",onClose:t})},Xo=y.memo(Qo);var jt={},Ko=g;Object.defineProperty(jt,"__esModule",{value:!0});var $a=jt.default=void 0,er=Ko(v()),tr=e,ar=(0,er.default)((0,tr.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");$a=jt.default=ar;var bt={},sr=g;Object.defineProperty(bt,"__esModule",{value:!0});var Oa=bt.default=void 0,nr=sr(v()),or=e,rr=(0,nr.default)((0,or.jsx)("path",{d:"M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z"}),"FormatAlignJustify");Oa=bt.default=rr;var St={},ir=g;Object.defineProperty(St,"__esModule",{value:!0});var Pa=St.default=void 0,lr=ir(v()),cr=e,dr=(0,lr.default)((0,cr.jsx)("path",{d:"M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"}),"FormatAlignLeft");Pa=St.default=dr;var Rt={},ur=g;Object.defineProperty(Rt,"__esModule",{value:!0});var kt=Rt.default=void 0,hr=ur(v()),mr=e,pr=(0,hr.default)((0,mr.jsx)("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"}),"Share");kt=Rt.default=pr;const Ia=t=>navigator.clipboard.writeText(t),fr=({onClose:t,showText:s})=>{const n=j(),a=p(h=>h.roster),o=p(h=>h.roster.units),r=()=>JSON.stringify(ya(a)),c=sa(o),l=()=>{const h=[];h.push(`${a.name} @${c} points`),h.push("=====================================");for(const f of Object.values(a.units)){h.push(""),h.push(`${f.customName?f.customName+" ("+f.name+")":f.name} @${f.points} points`);const R=[...f.options,...f.fantasticalRules];if(R.length)for(const w of R)h.push(`  - ${w}`)}return h.push(""),h.join(`
`)},i=()=>{const h=[];h.push(`**${a.name} --- ${c} points**`);for(const f of Object.values(a.units)){h.push(""),h.push(`* ${f.customName?f.customName+" ("+f.name+")":f.name} -- ${f.points} points`);const R=[...f.options,...f.fantasticalRules];if(R.length){h.push("");for(const w of R)h.push(`    - ${w}`)}}return h.push(""),h.join(`
`)},d=[["As an importable String",e.jsx($a,{})],["As text",e.jsx(Pa,{})],["As markdown text",e.jsx(Oa,{})]],u=[r,l,i],m=h=>{const f=u[d.reduce((R,w,Z)=>w[0]===h?Z:R,0)];try{const R=f();Ia(R),n(_("List copied to clipboard!","success"))}catch{n(_("Could not export the list!","error"))}};return e.jsx(Pe,{action:m,anchor:e.jsx(J,{text:"Export",icon:e.jsx(kt,{}),showText:s}),options:d,title:"Chose how to export",onClose:t})},xr=y.memo(fr);var Ct={},gr=g;Object.defineProperty(Ct,"__esModule",{value:!0});var _t=Ct.default=void 0,vr=gr(v()),yr=e,jr=(0,vr.default)((0,yr.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");_t=Ct.default=jr;const br=({onClose:t,showText:s})=>{const n=j(),a=o=>{if(o)try{const r=ja(JSON.parse(o));n(na({...r})),n(nt()),n(_("List imported!","success"))}catch{n(_("Could not import the list!","error"))}};return e.jsx(ga,{action:a,anchor:e.jsx(J,{text:"Import list",icon:e.jsx(_t,{}),showText:s}),title:"Enter the import string",label:"Import String",okayText:"Import",onClose:t})},Sr=y.memo(br);var wt={},Rr=g;Object.defineProperty(wt,"__esModule",{value:!0});var Fa=wt.default=void 0,kr=Rr(v()),Cr=e,_r=(0,kr.default)((0,Cr.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 16c-2.05 0-3.81-1.24-4.58-3h1.71c.63.9 1.68 1.5 2.87 1.5 1.93 0 3.5-1.57 3.5-3.5S13.93 9.5 12 9.5c-1.35 0-2.52.78-3.1 1.9l1.6 1.6h-4V9l1.3 1.3C8.69 8.92 10.23 8 12 8c2.76 0 5 2.24 5 5s-2.24 5-5 5z"}),"RestorePage");Fa=wt.default=_r;const wr=({showText:t,onClose:s})=>{const n=j();let a;const o=y.useRef(null),r=async()=>{try{const i=a.result,d=JSON.parse(i);d.hasOwnProperty("rosters")&&(await Promise.all(Object.entries(d.rosters).map(([u,m])=>te.setItem(u,m))),n(Ze(d.customData))),n(nt()),n(_("Restored!","success"))}catch(i){n(_("Could not restore!","error")),console.log(i)}s&&s()},c=i=>{a=new FileReader,a.onloadend=r,i.target.files&&a.readAsText(i.target.files[0])},l=()=>{o.current&&o.current.click()};return e.jsx(J,{text:"Restore",action:l,icon:e.jsx(Fa,{}),showText:t,children:e.jsx("input",{type:"file",ref:o,style:{display:"none"},id:"restoreFile",accept:".sav",onChange:c})})},Ar=y.memo(wr),Dr=()=>{const[t,s]=y.useState(!1),n=j(),a=()=>{n(da(!0)),s(!1)},o=c=>l=>{l.type==="keydown"&&(l.key==="Tab"||l.key==="Shift")||s(c)},r=G.useCallback(()=>s(!1),[]);return e.jsxs(e.Fragment,{children:[e.jsx(ka,{onClick:o(!0)}),e.jsx(Na,{open:t,onClose:o(!1),children:e.jsxs(z,{children:[e.jsx(V,{children:e.jsx(Ra,{onClose:r,showText:!0})},"Save"),e.jsx(V,{children:e.jsx(ba,{onClose:r,showText:!0})},"Load"),e.jsx(V,{children:e.jsx(Xo,{onClose:r,showText:!0})},"Delete"),e.jsx(xe,{}),e.jsx(V,{children:e.jsx(xr,{onClose:r,showText:!0})},"Export"),e.jsx(V,{children:e.jsx(Sr,{onClose:r,showText:!0})},"Import"),e.jsx(xe,{}),e.jsx(V,{children:e.jsx(zo,{onClose:r,showText:!0})},"Backup"),e.jsx(V,{children:e.jsx(Ar,{onClose:r,showText:!0})},"Restore"),e.jsx(xe,{}),e.jsxs(V,{children:[e.jsx(M,{title:"Customize",children:e.jsx(L,{color:"inherit",onClick:a,size:"large",children:e.jsx(qa,{})})}),e.jsx(x,{onClick:a,children:"Customize"})]},"Customize"),e.jsx(xe,{}),e.jsx(V,{children:e.jsx(ia,{showText:!0})},"InlineRules"),e.jsx(V,{children:e.jsx(qo,{showText:!0})},"DarkMode"),e.jsx(V,{children:e.jsx(Io,{onClose:r})},"About")]})})]})},Mr=y.memo(Dr),Et=({option:t,Icon:s,title:n})=>{const a=p(c=>c.ui[t]),o=j(),r=()=>{const c=t==="viewMode"?"editMode":"viewMode";o(ze(a?{[t]:!a}:{[t]:!a,[c]:!1}))};return e.jsx(M,{title:n,children:e.jsx(L,{color:"inherit","aria-label":n,onClick:r,size:"large",children:e.jsx(s,{fontSize:"small",color:a?"inherit":"disabled"})})})},$r=()=>{const t=p(n=>n.roster.units),s=sa(t);return e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"h4",sx:{display:{xs:"none",md:"block"}},children:["    Total Points  ",e.jsx(Le,{color:"secondary",size:"small",children:e.jsx(x,{variant:"h4",children:s})})]}),e.jsxs(x,{variant:"h4",sx:{display:{md:"none",xs:"block"}},children:["    ",e.jsx(Le,{color:"secondary",size:"small",children:e.jsx(x,{variant:"h4",children:s})})]})]})},Or=()=>{const t=j();return e.jsxs(b,{display:"flex",children:[e.jsx(Ga,{position:"fixed",children:e.jsxs(Vt,{children:[e.jsxs(b,{display:"flex",alignItems:"center",children:[e.jsx(Mr,{}),e.jsx(x,{variant:"h3",sx:{display:{xs:"none",md:"block"}},children:"  Dragon Rampant Army Builder  "}),e.jsx(x,{variant:"h3",sx:{display:{xs:"none",sm:"block",md:"none"}},children:"  DRAB  "}),e.jsx(L,{color:"inherit","aria-label":"reload",onClick:()=>t(Ks()),size:"large",children:e.jsx(ea,{})}),e.jsx(Ra,{}),e.jsx(ba,{})]}),e.jsx(b,{flexGrow:1}),e.jsxs(b,{display:"flex",alignItems:"center",children:[e.jsx(Et,{option:"viewMode",Icon:ta,title:"View mode"}),e.jsx(Et,{option:"editMode",Icon:Xe,title:"Edit mode"}),e.jsx(b,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(ia,{})}),e.jsx($r,{})]})]})}),e.jsx(Vt,{})]})},ge=({data:t,setData:s,customData:n,label:a,type:o})=>{const r=c=>l=>{l.target.checked?s(re(t,i=>{i[c][l.target.name]=n[c][l.target.name]})):s(re(t,i=>{delete i[c][l.target.name]}))};return e.jsx(e.Fragment,{children:Object.keys(n[o]).length!==0&&e.jsxs(e.Fragment,{children:[e.jsx(de,{children:a}),e.jsx(Ya,{children:Object.keys(n[o]).map(c=>e.jsx(Ue,{control:e.jsx(Be,{checked:t[o][c]!==void 0,onChange:r(o),name:c}),label:c},c))})]})})},Pr=({open:t,handleClose:s})=>{const[n,a]=y.useState(ye()),o=p(h=>h.data.customData),r=j(),c=()=>a(o),l=()=>a(ye()),i=Object.values(n).every(h=>Object.keys(h).length===0),d=Object.values(o).some(h=>Object.keys(h).length!==0),u=()=>{try{const h=JSON.stringify(n);Ia(h),r(_("Custom data copied to clipboard!","success")),s()}catch{r(_("Could not export the custom data!","error"))}},m={data:n,setData:a,customData:o};return e.jsxs(E,{onClose:s,open:t,children:[e.jsx(H,{children:"Export custom data"}),e.jsx(U,{children:e.jsxs(se,{variant:"standard",children:[d&&e.jsx(b,{mb:1,children:e.jsxs(Bt,{size:"small",color:"primary",variant:"text",children:[e.jsx(k,{onClick:c,children:"Select all"}),e.jsx(k,{onClick:l,children:"Select none"})]})}),e.jsx(ge,{label:"Units",type:"unitData",...m}),e.jsx(ge,{label:"Rules",type:"rulesData",...m}),e.jsx(ge,{label:"Fantastical Rules",type:"fantasticalRulesData",...m}),e.jsx(ge,{label:"Psychic Powers",type:"spells",...m})]})}),e.jsxs(Q,{children:[e.jsx(k,{onClick:s,color:"primary",children:"Cancel"}),e.jsx(k,{onClick:u,disabled:i,color:"primary",children:"Export"})]})]})};var Ir=function(t,s,n){return s===void 0&&(s={}),n===void 0&&(n={}),function(a,o,r){try{return Promise.resolve(function(c,l){try{var i=(s.context,Promise.resolve(t[n.mode==="sync"?"validateSync":"validate"](a,Object.assign({abortEarly:!1},s,{context:o}))).then(function(d){return r.shouldUseNativeValidation&&fs({},r),{values:n.raw?a:d,errors:{}}}))}catch(d){return l(d)}return i&&i.then?i.then(void 0,l):i}(0,function(c){if(!c.inner)throw c;return{values:{},errors:xs((l=c,i=!r.shouldUseNativeValidation&&r.criteriaMode==="all",(l.inner||[]).reduce(function(d,u){if(d[u.path]||(d[u.path]={message:u.message,type:u.type}),i){var m=d[u.path].types,h=m&&m[u.type];d[u.path]=gs(u.path,i,d,u.type,h?[].concat(h,u.message):u.message)}return d},{})),r)};var l,i}))}catch(c){return Promise.reject(c)}}},At={},Fr=g;Object.defineProperty(At,"__esModule",{value:!0});var Dt=At.default=void 0,Vr=Fr(v()),Wr=e,Lr=(0,Vr.default)((0,Wr.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddCircle");Dt=At.default=Lr;var Mt={},Tr=g;Object.defineProperty(Mt,"__esModule",{value:!0});var $t=Mt.default=void 0,zr=Tr(v()),Er=e,Hr=(0,zr.default)((0,Er.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");$t=Mt.default=Hr;const Ur=({data:t,actionOneName:s="Edit",ActionOneIcon:n=Xe,handleClickActionOne:a,actionTwoName:o="Delete",ActionTwoIcon:r=$t,handleClickActionTwo:c,actionSpecialName:l="Add new",ActionSpecialIcon:i=Dt,handleClickSpecialAction:d})=>e.jsxs(z,{children:[Object.keys(t).map(u=>e.jsxs(F,{id:u,children:[e.jsx(He,{children:e.jsx(L,{"aria-label":s,onClick:()=>a(u),size:"large",children:e.jsx(n,{color:"primary"})})}),e.jsx(P,{children:u}),e.jsx(Nt,{children:e.jsx(L,{size:"small","aria-label":o,onClick:()=>c(u),children:e.jsx(r,{color:"action"})})})]},u)),e.jsx(F,{id:"add_fr",children:e.jsx(k,{"aria-label":l,startIcon:e.jsx(i,{color:"secondary"}),onClick:d,children:l})},"add_fr")]}),Va=(t,s,n,a,o)=>{const[r,c]=G.useState(""),[l,i,d]=Y(),u=C=>Object.keys(t).every($=>$===r||$!==C),m=qt({resolver:Ir(s),context:{validateName:u}}),{reset:h}=m,f=C=>{C.name!==r&&a(r),o(C),d()},R=C=>{h({...t[C]}),c(C),i()},w=()=>{h({...n}),c(""),i()};return{ElementsList:()=>e.jsx(Ur,{data:t,handleClickActionOne:R,handleClickActionTwo:a,handleClickSpecialAction:w}),formContext:m,handleAction:f,open:l,handleClose:d}};function Ie(t){const{name:s,id:n,expanded:a,handleChange:o,data:r,CustomForm:c,schema:l,emptyState:i,removeFunc:d,addFunc:u}=t,{ElementsList:m,...h}=Va(r,l,i,d,u);return e.jsxs(Ce,{expanded:a===s,onChange:o(s),children:[e.jsx(_e,{expandIcon:e.jsx(ie,{}),"aria-controls":n+"-content",id:n+"-header",children:e.jsxs(x,{children:["Manage ",s]})}),e.jsxs(we,{children:[e.jsx(m,{}),e.jsx(c,{...h})]})]})}const Br=({defaultValues:t={},onSuccess:s=()=>{},FormProps:n,children:a})=>{const o=qt({defaultValues:t}),{handleSubmit:r}=o;return e.jsx(Te,{...o,children:e.jsx("form",{onSubmit:r(s),noValidate:!0,...n,children:a})})},pe=t=>!t.formContext&&!t.handleSubmit?e.jsx(Br,{...t}):t.handleSubmit&&t.formContext?e.jsx(Te,{...t.formContext,children:e.jsx("form",{noValidate:!0,...t.FormProps,onSubmit:t.handleSubmit,children:t.children})}):t.formContext&&t.onSuccess?e.jsx(Te,{...t.formContext,children:e.jsx("form",{onSubmit:t.formContext.handleSubmit(t.onSuccess),noValidate:!0,...t.FormProps,children:t.children})}):e.jsx("div",{children:"Incomplete setup of FormContainer.."});var Ot={},Nr=g;Object.defineProperty(Ot,"__esModule",{value:!0});var Wa=Ot.default=void 0,qr=Nr(v()),Gr=e,Yr=(0,qr.default)((0,Gr.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");Wa=Ot.default=Yr;const Jr=48,Zr=8;function je({menuItems:t,label:s="",valueKey:n="",labelKey:a="",required:o=!1,validation:r={},parseError:c,name:l,menuMaxHeight:i=Jr*4.5+Zr,menuMaxWidth:d=250,minWidth:u=120,helperText:m,showChips:h,variant:f,...R}){return o&&(r.required="This field is required"),e.jsx(Ye,{name:l,rules:r,render:({field:{value:w,onChange:Z,onBlur:C},fieldState:{invalid:$,error:B}})=>(m=B?typeof c=="function"?c(B):B.message:m,e.jsxs(se,{variant:f,sx:{minWidth:u},fullWidth:R.fullWidth,error:$,children:[e.jsx(Ae,{error:$,htmlFor:R.id||`select-multi-select-${l}`,required:o,children:s}),e.jsx(ue,{...R,id:R.id||`select-multi-select-${l}`,label:s,multiple:!0,error:$,value:w||[],required:o,onChange:Z,onBlur:C,MenuProps:{PaperProps:{style:{maxHeight:i,width:d}}},renderValue:h?T=>e.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:(T||[]).map(Fe=>e.jsx(ce,{label:Fe,sx:{display:"flex",flexWrap:"wrap"},onDelete:()=>{Z(w.filter(Ve=>Ve!==Fe))},deleteIcon:e.jsx(Wa,{onMouseDown:Ve=>{Ve.stopPropagation()}})},Fe))}):void 0,children:t.map(T=>e.jsx(ne,{value:n?T[n]:T,sx:{fontWeight:(w||[]).includes(T)?"bold":"normal"},children:a?T[a]:T},`${l}_${n?T[n]:T}`))}),m&&e.jsx(Ja,{children:m})]}))})}function I({validation:t={},parseError:s,type:n,required:a,name:o,...r}){return a&&(t.required="This field is required"),n==="email"&&(t.pattern={value:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Please enter a valid email address"}),e.jsx(Ye,{name:o,rules:t,render:({field:{value:c,onChange:l,onBlur:i},fieldState:{invalid:d,error:u}})=>e.jsx(Re,{...r,name:o,value:c??"",onChange:l,onBlur:i,required:a,type:n,error:d,helperText:u?typeof s=="function"?s(u):u.message:r.helperText})})}function ae({name:t,required:s,valueKey:n="",labelKey:a="",options:o=[],parseError:r,type:c,objectOnChange:l,validation:i={},...d}){var h;const u=!!((h=d.SelectProps)!=null&&h.native),m=u?"option":ne;return s&&(i.required="This field is required"),e.jsx(Ye,{name:t,rules:i,render:({field:{onBlur:f,onChange:R,value:w},fieldState:{invalid:Z,error:C}})=>(c==="number"&&w&&(d.InputLabelProps=d.InputLabelProps||{},d.InputLabelProps.shrink=!0),typeof w=="object"&&(w=w[n]),e.jsxs(Re,{...d,name:t,value:w??"",onBlur:f,onChange:$=>{let B=$.target.value;c==="number"&&(B=Number(B)),R(B),typeof d.onChange=="function"&&(l&&(B=o.find(T=>T[n]===B)),d.onChange(B))},select:!0,required:s,error:Z,helperText:C?typeof r=="function"?r(C):C.message:d.helperText,children:[u&&e.jsx("option",{}),o.map($=>G.createElement(m,{key:`${t}_${n?$[n]:$}`,value:n?$[n]:$},a?$[a]:$))]}))})}const Qr=()=>{const[t,s]=y.useState(null);return[t,o=>{s(o.currentTarget)},()=>{s(null)}]},be=({title:t,type:s,watch:n,setValue:a})=>{const[o,r,c]=Qr(),l=s==="setStats"?"range":"adjustRange";return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{id:"options-label",sx:{mt:2},children:t}),e.jsxs(z,{children:[Object.keys(n(s)||{}).map(i=>e.jsxs(F,{id:i,children:[e.jsx(ae,{name:s+"."+i,label:ee[i].name,type:"number",fullWidth:!0,options:ee[i][l]}),e.jsx(Nt,{children:e.jsx(L,{size:"small","aria-label":"Delete",onClick:()=>a(s,re(n(s),d=>{d&&delete d[i]})),children:e.jsx($t,{color:"action"})})})]},i)),e.jsxs(F,{id:"add_opt",children:[e.jsx(k,{onClick:r,startIcon:e.jsx(Dt,{}),children:"Add Stat"}),e.jsx(Za,{id:"add-stat-menu",anchorEl:o,keepMounted:!0,open:!!o,onClose:c,children:Object.keys(ee).filter(i=>!Object.keys(n(s)||{}).includes(i)).map(i=>e.jsx(ne,{onClick:()=>a(s,{...n(s),[i]:s==="setStats"?4:0}),children:ee[i].name},i))})]},"add_opt")]})]})};function Xr(t){const{formContext:s,open:n,handleClose:a,handleAction:o}=t,r=p(i=>Xt(i)),{watch:c,setValue:l}=s;return e.jsx(E,{open:n,children:e.jsxs(pe,{formContext:s,onSuccess:o,children:[e.jsx(H,{children:"Fantastical Rule"}),e.jsxs(U,{children:[e.jsx(I,{name:"name",label:"Name",type:"text",required:!0,margin:"normal",fullWidth:!0}),e.jsx(ae,{name:"points",label:"Points",margin:"normal",type:"number",fullWidth:!0,options:D(-4,6)}),e.jsx(I,{name:"description",label:"Description",type:"text",required:!0,margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(I,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0,sx:{mb:3}}),e.jsx(je,{name:"exclude_units",label:"Exclude Units",fullWidth:!0,menuItems:[...r]}),e.jsx(be,{title:"Set Stats",type:"setStats",watch:c,setValue:l}),e.jsx(be,{title:"Adjust Stats",type:"adjustStats",watch:c,setValue:l})]}),e.jsxs(Q,{children:[e.jsx(k,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(k,{type:"submit",color:"primary",children:"Okay"})]})]})})}const Kr=t=>vs(s=>X(ei(s,t))),ei=(t,s)=>Object.keys(t).reduce((n,a)=>({...n,[a]:s}),{}),fe=A().min(1).required().test("isUnique","The name must be unique!",(t,s)=>{var n;return(n=s.options.context)==null?void 0:n.validateName(t)}),Pt=X({attack:S().integer().min(0).max(12),move:S().integer().min(0).max(12),shoot:S().integer().min(0).max(12),courage:S().integer().min(0).max(12),armor:S().integer().min(0).max(6),attackValue:S().integer().min(0).max(6),defenceValue:S().integer().min(0).max(6),shootValue:S().integer().min(0).max(6),shootRange:S().integer().min(0).max(24),movement:S().integer().min(0).max(18),strengthPoints:S().oneOf([6,12])}),La=X({attack:S().integer().min(-12).max(12),move:S().integer().min(-12).max(12),shoot:S().integer().min(-12).max(12),courage:S().integer().min(-12).max(12),armor:S().integer().min(-6).max(6),attackValue:S().integer().min(-6).max(6),defenceValue:S().integer().min(-6).max(6),shootValue:S().integer().min(-6).max(6),shootRange:S().integer().min(-6).max(24),movement:S().integer().min(-18).max(18),strengthPoints:S().oneOf([-12,-6,0,6,12])}),Ta=X({name:fe,points:S().integer().required(),description:A().required(),short:A(),remove:K().of(A()),add:K().of(A()),setStats:Pt,adjustStats:La,disabledBy:K().of(A()),enabledBy:K().of(A())}),ti=X({name:fe,type:A(),points:S().integer().min(1).required(),stats:Pt,rules:K().of(A()),fantasticalRules:K().of(A()),options:Kr(Ta)}),ai={name:"",points:0,description:""},si={name:"",type:"foot",points:2,stats:{attack:5,move:6,shoot:0,courage:4,armor:2,attackValue:5,defenceValue:5,shootValue:0,shootRange:0,movement:6,strengthPoints:6},rules:[],options:{},fantasticalRules:[]},ni=X({name:fe,points:S().integer().min(0).required(),exclude_units:K().of(A()),description:A().required(),short:A(),setStats:Pt,adjustStats:La}),oi={name:"",points:0,exclude_units:[],description:""};function ri(t){const{expanded:s,handleChange:n}=t,a=j(),o=p(i=>i.data.customData.fantasticalRulesData),r=p(i=>i.roster.units),c=i=>{Object.values(r).some(d=>d.fantasticalRules.includes(i))?a(_("You can't delete a rule currently in use!","error")):a(Ds(i))},l=i=>a(As(i));return e.jsx(Ie,{name:"Fantastical Rules",id:"fantastical-rules",expanded:s,handleChange:n,data:o,CustomForm:Xr,schema:ni,emptyState:{...oi},removeFunc:c,addFunc:l})}const ii=y.memo(ri),li=({open:t,handleClose:s})=>{const n=j(),[a,o]=y.useState(""),r=()=>{if(!a){n(_("You have to input some data!","error"));return}try{const i=JSON.parse(a);n(Ze(i)),n(_("Custom data imported!","success"))}catch{n(_("Could not import the custom data!","error"))}},c=i=>{i==="Enter"?l():i==="ESC"&&s()},l=()=>{r(),s()};return e.jsxs(E,{onClose:s,open:t,children:[e.jsx(H,{children:"Enter the import string"}),e.jsx(U,{children:e.jsx(Re,{variant:"standard",autoFocus:!0,margin:"normal",label:"Import String",type:"text",fullWidth:!0,onChange:i=>o(i.target.value),onKeyPress:i=>c(i.key)})}),e.jsxs(Q,{children:[e.jsx(k,{onClick:s,color:"primary",children:"Cancel"}),e.jsx(k,{onClick:l,disabled:!a,color:"primary",children:"Import"})]})]})},ci=y.memo(li);function di(t){const{formContext:s,open:n,handleClose:a,handleAction:o}=t;return e.jsx(E,{open:n,children:e.jsxs(pe,{formContext:s,onSuccess:o,children:[e.jsx(H,{children:"Rule"}),e.jsxs(U,{children:[e.jsx(I,{name:"name",label:"Name",type:"text",required:!0,margin:"normal",fullWidth:!0}),e.jsx(I,{name:"description",label:"Description",type:"text",required:!0,margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(I,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0})]}),e.jsxs(Q,{children:[e.jsx(k,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(k,{type:"submit",color:"primary",children:"Okay"})]})]})})}const ui=X({name:fe,description:A(),short:A()}),hi={name:"",description:""};function mi(t){const{expanded:s,handleChange:n}=t,a=j(),o=p(i=>i.data.customData),r=p(i=>i.roster.units),c=i=>{Object.values(r).some(d=>d.rules.includes(i))||Object.values(o.unitData).some(d=>d.rules.includes(i))?a(_("You can't delete a rule currently in use!","error")):a(Ps(i))},l=i=>a(Os(i));return e.jsx(Ie,{name:"Rules",id:"rules",expanded:s,handleChange:n,data:o.rulesData,CustomForm:di,schema:ui,emptyState:{...hi},removeFunc:c,addFunc:l})}const pi=y.memo(mi);function fi(t){const{formContext:s,open:n,handleClose:a,handleAction:o}=t;return e.jsx(E,{open:n,children:e.jsxs(pe,{formContext:s,onSuccess:o,children:[e.jsx(H,{children:"Spell"}),e.jsxs(U,{children:[e.jsx(I,{name:"name",label:"Name",type:"text",required:!0,margin:"normal",fullWidth:!0}),e.jsx(ae,{name:"difficulty",label:"Difficulty",type:"number",margin:"normal",fullWidth:!0,options:D(2,12)}),e.jsx(I,{name:"target",label:"Target",type:"text",required:!0,margin:"normal",fullWidth:!0}),e.jsx(I,{name:"duration",label:"Duration",type:"text",required:!0,margin:"normal",fullWidth:!0}),e.jsx(I,{name:"effect",label:"Effekt",type:"text",required:!0,margin:"normal",fullWidth:!0,multiline:!0}),e.jsx(I,{name:"short",label:"Short description",type:"text",margin:"normal",fullWidth:!0,multiline:!0})]}),e.jsxs(Q,{children:[e.jsx(k,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(k,{type:"submit",color:"primary",children:"Okay"})]})]})})}const xi=X({name:fe,difficulty:S().integer().min(2).max(12),target:A(),duration:A(),effect:A(),short:A()}),gi={name:"",difficulty:7,target:"",duration:"",effect:""};function vi(t){const{expanded:s,handleChange:n}=t,a=j(),o=p(l=>l.data.customData.spells),r=l=>a($s(l)),c=l=>a(Ms(l));return e.jsx(Ie,{name:"Spells",id:"spells",expanded:s,handleChange:n,data:o,CustomForm:fi,schema:xi,emptyState:{...gi},removeFunc:r,addFunc:c})}const yi=y.memo(vi),ji=({formContext:t,open:s,handleClose:n,handleAction:a,rules:o})=>{const r=p(u=>u.data.rulesData),{handleSubmit:c,watch:l,setValue:i}=t,d=u=>{u.preventDefault(),u.stopPropagation(),c(a)(u)};return e.jsxs(E,{onClose:n,open:s,children:[e.jsx(H,{children:"Option"}),e.jsxs(pe,{formContext:t,handleSubmit:d,children:[e.jsxs(U,{children:[e.jsx(I,{name:"name",label:"Name",type:"text",required:!0,fullWidth:!0}),e.jsx(ae,{name:"points",label:"Points",type:"number",fullWidth:!0,options:D(-4,6)}),e.jsx(I,{name:"description",label:"Description",type:"text",required:!0,fullWidth:!0,multiline:!0}),e.jsx(I,{name:"short",label:"Short description",type:"text",fullWidth:!0,multiline:!0,sx:{mb:3}}),e.jsx(je,{name:"remove",label:"Remove Rules",fullWidth:!0,menuItems:[...o],sx:{mb:3}}),e.jsx(je,{name:"add",label:"Add Rules",fullWidth:!0,menuItems:[...Object.keys(r)],sx:{mb:3}}),e.jsx(be,{title:"Set Stats",type:"setStats",watch:l,setValue:i}),e.jsx(be,{title:"Adjust Stats",type:"adjustStats",watch:l,setValue:i})]}),e.jsxs(Q,{children:[e.jsx(k,{onClick:n,color:"primary",children:"Cancel"}),e.jsx(k,{type:"submit",color:"primary",children:"Okay"})]})]})]})},q=({stat:t,isPhone:s})=>{const n=ee[t];return e.jsxs(e.Fragment,{children:[e.jsx(O,{children:s?n.shortName:n.name}),e.jsx(O,{children:e.jsx(ae,{size:"small",name:"stats."+t,type:"number",options:n.range})})]})},bi=()=>{const t=Ht(),s=Se(t.breakpoints.down("sm"));return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{id:"stats-label",sx:{mt:2},children:"Stats"}),e.jsx(Ne,{children:e.jsx(qe,{size:"small",children:e.jsxs(Ge,{children:[e.jsxs(W,{children:[e.jsx(q,{stat:"attack",isPhone:s}),e.jsx(q,{stat:"attackValue",isPhone:s})]}),e.jsxs(W,{children:[e.jsx(q,{stat:"move",isPhone:s}),e.jsx(q,{stat:"defenceValue",isPhone:s})]}),e.jsxs(W,{children:[e.jsx(q,{stat:"shoot",isPhone:s}),e.jsx(q,{stat:"shootValue",isPhone:s})]}),e.jsxs(W,{children:[e.jsx(q,{stat:"courage",isPhone:s}),e.jsx(q,{stat:"shootRange",isPhone:s})]}),e.jsxs(W,{children:[e.jsx(q,{stat:"armor",isPhone:s}),e.jsx(q,{stat:"movement",isPhone:s})]})]})})})]})};function Si(t){const{formContext:s,open:n,handleClose:a,handleAction:o}=t,{watch:r,setValue:c}=s,l=p(h=>h.data.rulesData),i=h=>{c("options",re(r("options"),f=>{delete f[h]}))},d=h=>c("options",{...r("options"),[h.name]:h}),{ElementsList:u,...m}=Va(r("options"),Ta,ai,i,d);return e.jsx(E,{open:n,children:e.jsxs(pe,{formContext:s,onSuccess:o,children:[e.jsx(H,{children:"Unit"}),e.jsxs(U,{children:[e.jsx(I,{name:"name",label:"Name",type:"text",required:!0,fullWidth:!0}),e.jsx(ae,{name:"points",label:"Points",type:"number",fullWidth:!0,options:D(1,10)}),e.jsx(ae,{name:"stats.strengthPoints",label:"Strength Points",type:"number",fullWidth:!0,options:ee.strengthPoints.range}),e.jsx(bi,{}),e.jsx(je,{name:"rules",label:"Rules",fullWidth:!0,sx:{mb:2},menuItems:[...Object.keys(l)]}),e.jsx(Ae,{id:"options-label",children:"Options"}),e.jsx(u,{}),e.jsx(ji,{...m,rules:r("rules")})]}),e.jsxs(Q,{children:[e.jsx(k,{onClick:a,color:"primary",children:"Cancel"}),e.jsx(k,{type:"submit",color:"primary",children:"Okay"})]})]})})}function Ri(t){const{expanded:s,handleChange:n}=t,a=j(),o=p(i=>i.data.customData.unitData),r=p(i=>i.roster.units),c=i=>{Object.values(r).some(d=>d.name===i)?a(_("You can't delete a unit currently in use!","error")):a(ws(i))},l=i=>a(_s(i));return e.jsx(Ie,{name:"Units",id:"units",expanded:s,handleChange:n,data:o,CustomForm:Si,schema:ti,emptyState:{...si},removeFunc:c,addFunc:l})}const ki=y.memo(Ri),Ci=()=>{const t=p(m=>m.appState.customizeMode),s=j(),[n,a]=G.useState(""),[o,r,c]=Y(),[l,i,d]=Y(),u=G.useCallback(m=>(h,f)=>{a(f?m:"")},[]);return e.jsxs(E,{open:t,onClose:()=>s(da(!1)),children:[e.jsx(H,{children:"Customize"}),e.jsxs(U,{children:[e.jsx(ki,{expanded:n,handleChange:u}),e.jsx(ii,{expanded:n,handleChange:u}),e.jsx(pi,{expanded:n,handleChange:u}),e.jsx(yi,{expanded:n,handleChange:u}),e.jsx(he,{sx:{mt:3},children:e.jsxs(Bt,{color:"primary",variant:"outlined",children:[e.jsx(k,{"aria-label":"Import custom data",startIcon:e.jsx(_t,{}),onClick:()=>r(),children:"Import"}),e.jsx(k,{"aria-label":"Export custom data",startIcon:e.jsx(kt,{}),onClick:()=>i(),children:"Export"})]})})]}),e.jsx(ci,{open:o,handleClose:c}),e.jsx(Pr,{open:l,handleClose:d})]})},_i=y.memo(Ci),wi=()=>{const t=j(),s=p(a=>a.roster.name),n=p(a=>a.appState.inputUpdate);return e.jsx(se,{variant:"standard",children:e.jsx(x,{"aria-label":"List name",variant:"h2",component:"input",value:s,onChange:a=>t(en({name:a.target.value})),sx:{backgroundColor:"transparent",color:"text.primary",border:0,marginTop:"25px",marginBottom:"25px",width:"100%"}},n.toString())})},Ai=()=>{const t=j(),s=p(a=>a.ui.rulesSummaryExpanded),n=p(a=>Qs(a));return e.jsxs(Ce,{expanded:s,onChange:()=>t(Oe("rulesSummaryExpanded")),sx:{maxWidth:1210},children:[e.jsx(_e,{expandIcon:e.jsx(ie,{}),children:e.jsx(x,{variant:"h3",children:"Rules Summary"})}),e.jsx(we,{sx:{maxWidth:800},children:e.jsx(z,{children:Object.values(n).map(a=>e.jsx(F,{children:e.jsx(P,{primary:a.name,secondary:a.description||""})},a.name))})})]})},Di=()=>{const t=j(),s=p(a=>a.appState.feedback),n=(a,o)=>{o!=="clickaway"&&t(yn())};return e.jsx(Qa,{open:s.open,autoHideDuration:6e3,onClose:n,children:e.jsx(Xa,{onClose:n,severity:s.severity,variant:"filled",elevation:6,children:s.message})})};var It={},Mi=g;Object.defineProperty(It,"__esModule",{value:!0});var za=It.default=void 0,$i=Mi(v()),Oi=e,Pi=(0,$i.default)((0,Oi.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");za=It.default=Pi;const Ii=()=>{const t=j(),s=p(l=>Xs(l)),n=p(l=>l.ui.powersExpanded),[a,o]=G.useState([...Array(Object.keys(s))].map(()=>!1)),r=s&&Object.keys(s).length>0,c=l=>{const i=[...a];i[l]=!a[l],o(i)};return e.jsx(e.Fragment,{children:r&&e.jsxs(Ce,{expanded:n,onChange:()=>t(Oe("powersExpanded")),sx:{maxWidth:1210},children:[e.jsx(_e,{expandIcon:e.jsx(ie,{}),children:e.jsx(x,{variant:"h3",children:"Spell Table"})}),e.jsxs(we,{sx:{maxWidth:800},children:[e.jsx(Ne,{sx:{display:{xs:"none",md:"block"}},children:e.jsxs(qe,{size:"small",sx:{minWidth:650},children:[e.jsx(Ka,{children:e.jsxs(W,{children:[e.jsx(O,{sx:{minWidth:120},children:"Spell name"}),e.jsx(O,{align:"center",sx:{display:{md:"none",lg:"block"}},children:"Difficulty"}),e.jsx(O,{align:"center",sx:{display:{md:"block",lg:"none"}},children:"Dif"}),e.jsx(O,{children:"Target"}),e.jsx(O,{children:"Duration"}),e.jsx(O,{children:"Effect"})]},"headpowertable")}),e.jsx(Ge,{children:Object.values(s).map(l=>e.jsxs(W,{children:[e.jsx(O,{component:"th",scope:"row",children:l.name}),e.jsxs(O,{align:"center",children:[l.difficulty,"+"]}),e.jsx(O,{children:l.target}),e.jsx(O,{children:l.duration}),e.jsx(O,{children:l.effect})]},l.name))})]})}),e.jsx(z,{sx:{display:{md:"none",xs:"block"}},children:Object.values(s).map((l,i)=>e.jsxs(b,{children:[e.jsxs(F,{onClick:()=>c(i),children:[e.jsx(P,{primary:l.name}),e.jsx(b,{width:25}),a[i]?e.jsx(za,{}):e.jsx(ie,{})]},l.name+"small"),e.jsx(Ut,{in:a[i],timeout:"auto",unmountOnExit:!0,children:e.jsxs(z,{dense:!0,sx:{pl:3},children:[e.jsx(F,{children:e.jsx(P,{primary:"Difficulty: ",secondary:l.difficulty})},l.name+l.difficulty),e.jsx(F,{children:e.jsx(P,{primary:"Target: ",secondary:l.target})},l.name+l.target),e.jsx(F,{children:e.jsx(P,{primary:"Duration: ",secondary:l.duration})},l.name+l.duration),e.jsx(F,{children:e.jsx(P,{primary:"Effect: ",secondary:l.effect})},l.name+l.effect)]},l.name+"list")})]},i))})]})]})})},Fi=()=>{const t=j(),s=p(o=>o.ui.validationExpanded),n=Object.values(p(o=>o.roster.units)),a=[];for(const o of n){const r=!o.fantasticalRules.some(c=>["Psychic 1","Psychic 2","Psychic 3","Psychic 4"].includes(c));o.points>12&&a.push([o.name,"No Unit may cost more than 12 points!"]),o.name!=="Unit"&&o.points<1&&a.push([o.name,"No Unit may cost less than one point!"]),o.fantasticalRules.includes("Fanatical Discipline")&&o.stats.courage<3&&a.push([o.name,"This unit can´t have less than 3 courage!"]),o.fantasticalRules.includes("Hive Mind")&&o.fantasticalRules.includes("Commander")&&a.push([o.name,"A Commander can´t have Hive Mind!"]),o.fantasticalRules.includes("Slow")&&o.options.includes("Mobile")&&a.push([o.name,"Slow and Mobile can´t be used together!"]),o.fantasticalRules.includes("Contagious")&&!(o.fantasticalRules.includes("Demonic")||o.fantasticalRules.includes("Undead"))&&a.push([o.name,"Conatagious can only be taken by demonic or undead units!"]),o.fantasticalRules.includes("Psychic Hazards")&&!r&&a.push([o.name,"Only a psychic unit can take Psychic Hazards!"]),(o.fantasticalRules.includes("Psychic Species 1")||o.fantasticalRules.includes("Psychic Species 2")||o.fantasticalRules.includes("Psychic Species 3"))&&!r&&a.push([o.name,"Only a psychic unit can take Psychic Species!"]),o.fantasticalRules.includes("Psychic 1")&&o.spells&&o.spells.length>1&&a.push([o.name,"A Psychic 1 unit can only take 1 Psychic Power!"]),o.fantasticalRules.includes("Psychic 2")&&o.spells&&o.spells.length>2&&a.push([o.name,"A Psychic 2 unit can only take 2 Psychic Powers!"]),o.fantasticalRules.includes("Psychic 3")&&o.spells&&o.spells.length>3&&a.push([o.name,"A Psychic 3 unit can only take 3 Psychic Powers!"]),o.fantasticalRules.includes("Psychic 4")&&o.spells&&o.spells.length>3&&a.push([o.name,"A Psychic 4 unit can only take 3 Psychic Powers!"])}return e.jsx(e.Fragment,{children:a.length!==0&&e.jsxs(Ce,{expanded:s,onChange:()=>t(Oe("validationExpanded")),sx:{maxWidth:"breakpoints.values.lg"},children:[e.jsx(_e,{sx:{backgroundColor:"error.main",color:"error.contrastText"},expandIcon:e.jsx(es,{sx:{color:"error.contrastText"}}),children:e.jsx(x,{variant:"h3",children:"Warnings"})}),e.jsx(we,{sx:{backgroundColor:"error.light",color:"error.contrastText"},children:e.jsx(z,{children:a.map(([o,r],c)=>e.jsxs(F,{children:[e.jsx(He,{sx:{color:"error.contrastText"},children:e.jsx(ts,{})}),e.jsx(P,{primary:o,secondary:r})]},c))})})]})})},Vi=()=>{const t=js(),s=j();return G.useEffect(()=>{s(Jt())},[s]),e.jsx(as,{injectFirst:!0,children:e.jsxs(ss,{theme:t,children:[e.jsx(ns,{}),e.jsxs(he,{sx:{mb:3},children:[e.jsx(Or,{}),e.jsx(wi,{}),e.jsx(mo,{}),e.jsx(Fi,{}),e.jsx(Ai,{}),e.jsx(Ii,{}),e.jsx(Di,{}),e.jsx(_i,{})]})]})})},Wi=Gt(document.getElementById("root"));Wi.render(e.jsx(ms,{store:Ee,children:e.jsx(Vi,{})}));
